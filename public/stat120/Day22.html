<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Multiple comparisons</title>
    <meta charset="utf-8" />
    <meta name="author" content="Bastola" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <link href="libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"Copy Code","success":"Copied!","error":"Press Ctrl+C to Copy"})</script>
    <link href="libs/xaringanExtra-extra-styles/xaringanExtra-extra-styles.css" rel="stylesheet" />
    <script>window.xaringanExtraClipboard(null, {"button":"<i class=\"fa fa-clipboard\"><\/i>","success":"<i class=\"fa fa-check\" style=\"color: #90BE6D\"><\/i>","error":"<i class=\"fa fa-times-circle\" style=\"color: #F94144\"><\/i>"})</script>
    <link href="libs/font-awesome/css/all.css" rel="stylesheet" />
    <link href="libs/font-awesome/css/v4-shims.css" rel="stylesheet" />
    <link href="libs/countdown/countdown.css" rel="stylesheet" />
    <script src="libs/countdown/countdown.js"></script>
    <script src="https://use.fontawesome.com/5235085b15.js"></script>

    <link rel="stylesheet" href="css/xaringan-themer-solns.css" type="text/css" />
    <link rel="stylesheet" href="css/my-theme.css" type="text/css" />
    <link rel="stylesheet" href="css/my-font.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">








layout: true
  
---

class: title-slide, middle

# .fancy[ANOVA Pairwise Comparisons]

### .fancy[Stat 120]

 May 18 2022

---

class: middle

# Post-ANOVA

.blockquote.font90[
- Inference .bold[AFTER] doing .bold[ANOVA] to compare means for several groups:

    - Confidence interval for a single mean
    - Confidence interval for a difference in two means
    - Pairwise t-test for a difference in two means

]

---

class: middle

# ANOVA for Difference in Means

.blockquote.font90[
- .bold[Data:] Random samples of size `\(n_1, n_2, \cdots , n_k\)` from each of k populations (or groups)

- .bold[Summary statistics:]

    - Sample mean for each group
    - Std. dev. for each group
    - Mean and std. dev. for all values

]

---

class: middle

# ANOVA for Difference in Means

.blockquote[
`$$H_0:\mu_1 = \mu_2 = \cdots = \mu_k$$`
`$$H_a: \text{at least one } \mu_i \text{ is different}$$`

- .bold[Conditions:] Similar variability AND either sample sizes in each group are large (each `\(n_i \geq 30\)`) OR the data are relatively normally distributed
]

---

class: middle

# Cuckoo Birds

.pull-left-60[
.blockquote.font80[
- Cuckoo birds lay their eggs in the nests of other birds

- When the cuckoo baby hatches, it kicks out all the original eggs/babies

- If the cuckoo is lucky, the mother will raise the cuckoo as if it were her own
  - Do cuckoo bird eggs found in nests of different species differ in size?
]
]

.pull-right-40[
&lt;br&gt;
&lt;br&gt;
&lt;center&gt;
&lt;img src="images/cuckoo.jpg" width="60%" height="60%"&gt; &lt;br&gt;
&lt;a&gt;Cuckoo bird in nest&lt;/a&gt;
&lt;/center&gt;
]

---

class: middle

# Cuckoo Dataset

.pull-left[
.blockquote.font90[
- .bold[cuckoo] dataset contains information on 120 Cuckoo eggs, obtained from randomly selected "foster" nests.

- researchers have measured the `length` (in mm) and established the `type` (species) of foster parent.
]

]
.pull-right[
.blockquote[
&lt;br&gt;
- `type=1`: Meadow pipit
- `type=2`: Tree pipit
- `type=3`: Dunnock
- `type=4`: European robin
- `type=5`: White wagtail
- `type=6`: Eurasian wren
]

]

---

class: inverse, middle

.bold.large[Goal: test if the type of foster parent has an effect on the average length of the cuckoo eggs.]

---

count: false
 
## ANOVA
.panel1-cuckoo-auto[

```r
*library(dplyr)
```
]
 
.panel2-cuckoo-auto[

]

---
count: false
 
## ANOVA
.panel1-cuckoo-auto[

```r
library(dplyr)
*cuckoo &lt;-  read.csv("https://raw.githubusercontent.com/deepbas/statdatasets/main/cuckoo.dat", sep = "")
```
]
 
.panel2-cuckoo-auto[

]

---
count: false
 
## ANOVA
.panel1-cuckoo-auto[

```r
library(dplyr)
cuckoo &lt;-  read.csv("https://raw.githubusercontent.com/deepbas/statdatasets/main/cuckoo.dat", sep = "")
*cuckoo &lt;- cuckoo
```
]
 
.panel2-cuckoo-auto[

]

---
count: false
 
## ANOVA
.panel1-cuckoo-auto[

```r
library(dplyr)
cuckoo &lt;-  read.csv("https://raw.githubusercontent.com/deepbas/statdatasets/main/cuckoo.dat", sep = "")
cuckoo &lt;- cuckoo %&gt;%
* `colnames&lt;-`(c("length", "type"))
```
]
 
.panel2-cuckoo-auto[

]

---
count: false
 
## ANOVA
.panel1-cuckoo-auto[

```r
library(dplyr)
cuckoo &lt;-  read.csv("https://raw.githubusercontent.com/deepbas/statdatasets/main/cuckoo.dat", sep = "")
cuckoo &lt;- cuckoo %&gt;%
  `colnames&lt;-`(c("length", "type")) %&gt;%
* mutate(type = as.factor(type))
```
]
 
.panel2-cuckoo-auto[

]

---
count: false
 
## ANOVA
.panel1-cuckoo-auto[

```r
library(dplyr)
cuckoo &lt;-  read.csv("https://raw.githubusercontent.com/deepbas/statdatasets/main/cuckoo.dat", sep = "")
cuckoo &lt;- cuckoo %&gt;%
  `colnames&lt;-`(c("length", "type")) %&gt;%
  mutate(type = as.factor(type))

*stat &lt;- cuckoo
```
]
 
.panel2-cuckoo-auto[

]

---
count: false
 
## ANOVA
.panel1-cuckoo-auto[

```r
library(dplyr)
cuckoo &lt;-  read.csv("https://raw.githubusercontent.com/deepbas/statdatasets/main/cuckoo.dat", sep = "")
cuckoo &lt;- cuckoo %&gt;%
  `colnames&lt;-`(c("length", "type")) %&gt;%
  mutate(type = as.factor(type))

stat &lt;- cuckoo %&gt;%
* group_by(type)
```
]
 
.panel2-cuckoo-auto[

]

---
count: false
 
## ANOVA
.panel1-cuckoo-auto[

```r
library(dplyr)
cuckoo &lt;-  read.csv("https://raw.githubusercontent.com/deepbas/statdatasets/main/cuckoo.dat", sep = "")
cuckoo &lt;- cuckoo %&gt;%
  `colnames&lt;-`(c("length", "type")) %&gt;%
  mutate(type = as.factor(type))

stat &lt;- cuckoo %&gt;%
  group_by(type) %&gt;%
* summarize(mean(length),
*           sd(length),
*           length(length))
```
]
 
.panel2-cuckoo-auto[

]

---
count: false
 
## ANOVA
.panel1-cuckoo-auto[

```r
library(dplyr)
cuckoo &lt;-  read.csv("https://raw.githubusercontent.com/deepbas/statdatasets/main/cuckoo.dat", sep = "")
cuckoo &lt;- cuckoo %&gt;%
  `colnames&lt;-`(c("length", "type")) %&gt;%
  mutate(type = as.factor(type))

stat &lt;- cuckoo %&gt;%
  group_by(type) %&gt;%
  summarize(mean(length),
            sd(length),
            length(length))%&gt;%
* `colnames&lt;-`(c( "Type", "mean", "sd", "n"))
```
]
 
.panel2-cuckoo-auto[

]

---
count: false
 
## ANOVA
.panel1-cuckoo-auto[

```r
library(dplyr)
cuckoo &lt;-  read.csv("https://raw.githubusercontent.com/deepbas/statdatasets/main/cuckoo.dat", sep = "")
cuckoo &lt;- cuckoo %&gt;%
  `colnames&lt;-`(c("length", "type")) %&gt;%
  mutate(type = as.factor(type))

stat &lt;- cuckoo %&gt;%
  group_by(type) %&gt;%
  summarize(mean(length),
            sd(length),
            length(length))%&gt;%
  `colnames&lt;-`(c( "Type", "mean", "sd", "n"))
*stat &lt;- as.data.frame(stat)
```
]
 
.panel2-cuckoo-auto[

]

---
count: false
 
## ANOVA
.panel1-cuckoo-auto[

```r
library(dplyr)
cuckoo &lt;-  read.csv("https://raw.githubusercontent.com/deepbas/statdatasets/main/cuckoo.dat", sep = "")
cuckoo &lt;- cuckoo %&gt;%
  `colnames&lt;-`(c("length", "type")) %&gt;%
  mutate(type = as.factor(type))

stat &lt;- cuckoo %&gt;%
  group_by(type) %&gt;%
  summarize(mean(length),
            sd(length),
            length(length))%&gt;%
  `colnames&lt;-`(c( "Type", "mean", "sd", "n"))
stat &lt;- as.data.frame(stat)
*knitr::kable(stat)
```
]
 
.panel2-cuckoo-auto[

|Type |     mean|        sd|  n|
|:----|--------:|---------:|--:|
|1    | 22.51636| 1.8058292| 44|
|2    | 23.09000| 0.9014274| 15|
|3    | 23.12143| 1.0687365| 14|
|4    | 22.57500| 0.6845923| 16|
|5    | 22.90333| 1.0676186| 15|
|6    | 21.13000| 0.7437357| 15|
]

&lt;style&gt;
.panel1-cuckoo-auto {
  color: black;
  width: 71.54%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 70%
}
.panel2-cuckoo-auto {
  color: black;
  width: 26.46%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 70%
}
.panel3-cuckoo-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 70%
}
&lt;/style&gt;





---

count: false
 
## Side-by-side Boxplot (1a)
.panel1-boxplot-auto[

```r
*cuckoo
```
]
 
.panel2-boxplot-auto[

```
    length type
1    21.73    1
2    21.73    1
3    23.99    1
4    22.44    1
5    22.97    1
6    20.88    1
7    22.53    1
8    22.09    1
9    24.17    1
10   23.85    1
11   22.99    1
12   20.00    1
13   20.55    1
14   22.42    1
15   20.24    1
16   24.24    1
17   22.91    1
18   19.60    1
19   21.69    1
20   22.88    1
21   23.87    1
22   24.18    1
23   23.33    1
24   19.92    1
25   25.88    1
26   24.16    1
27   21.71    1
28   17.69    1
29   23.11    1
30   20.92    1
31   23.74    1
32   22.93    1
33   24.92    1
34   23.47    1
35   18.68    1
36   21.99    1
37   23.20    1
38   23.70    1
39   25.53    1
40   23.26    1
41   24.63    1
42   24.12    1
43   20.09    1
44   21.79    1
45   21.05    2
46   21.85    2
47   22.05    2
48   22.45    2
49   22.65    2
50   23.25    2
51   23.25    2
52   23.25    2
53   23.45    2
54   23.45    2
55   23.65    2
56   23.85    2
57   24.05    2
58   24.05    2
59   24.05    2
60   20.85    3
61   21.65    3
62   22.05    3
63   22.85    3
64   23.05    3
65   23.05    3
66   23.05    3
67   23.05    3
68   23.45    3
69   23.85    3
70   23.85    3
71   23.85    3
72   24.05    3
73   25.05    3
74   21.05    4
75   21.85    4
76   22.05    4
77   22.05    4
78   22.05    4
79   22.25    4
80   22.45    4
81   22.45    4
82   22.65    4
83   23.05    4
84   23.05    4
85   23.05    4
86   23.05    4
87   23.05    4
88   23.25    4
89   23.85    4
90   21.05    5
91   21.85    5
92   21.85    5
93   21.85    5
94   22.05    5
95   22.45    5
96   22.65    5
97   23.05    5
98   23.05    5
99   23.25    5
100  23.45    5
101  24.05    5
102  24.05    5
103  24.05    5
104  24.85    5
105  19.85    6
106  20.05    6
107  20.25    6
108  20.85    6
109  20.85    6
110  20.85    6
111  21.05    6
112  21.05    6
113  21.05    6
114  21.25    6
115  21.45    6
116  22.05    6
117  22.05    6
118  22.05    6
119  22.25    6
```
]

---
count: false
 
## Side-by-side Boxplot (1a)
.panel1-boxplot-auto[

```r
cuckoo %&gt;%
* ggplot(aes(x=type,y=length,fill=type))
```
]
 
.panel2-boxplot-auto[
&lt;img src="Day22_files/figure-html/boxplot_auto_02_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Side-by-side Boxplot (1a)
.panel1-boxplot-auto[

```r
cuckoo %&gt;%
  ggplot(aes(x=type,y=length,fill=type)) +
* theme_bw()
```
]
 
.panel2-boxplot-auto[
&lt;img src="Day22_files/figure-html/boxplot_auto_03_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Side-by-side Boxplot (1a)
.panel1-boxplot-auto[

```r
cuckoo %&gt;%
  ggplot(aes(x=type,y=length,fill=type)) +
  theme_bw() +
* geom_boxplot()
```
]
 
.panel2-boxplot-auto[
&lt;img src="Day22_files/figure-html/boxplot_auto_04_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Side-by-side Boxplot (1a)
.panel1-boxplot-auto[

```r
cuckoo %&gt;%
  ggplot(aes(x=type,y=length,fill=type)) +
  theme_bw() +
  geom_boxplot() +
* geom_jitter(width = 0.2)
```
]
 
.panel2-boxplot-auto[
&lt;img src="Day22_files/figure-html/boxplot_auto_05_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Side-by-side Boxplot (1a)
.panel1-boxplot-auto[

```r
cuckoo %&gt;%
  ggplot(aes(x=type,y=length,fill=type)) +
  theme_bw() +
  geom_boxplot() +
  geom_jitter(width = 0.2) +
* labs(title ="Boxplot of the length of eggs per type",
*      y = "length (mm)",
*      x = "type")
```
]
 
.panel2-boxplot-auto[
&lt;img src="Day22_files/figure-html/boxplot_auto_06_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Side-by-side Boxplot (1a)
.panel1-boxplot-auto[

```r
cuckoo %&gt;%
  ggplot(aes(x=type,y=length,fill=type)) +
  theme_bw() +
  geom_boxplot() +
  geom_jitter(width = 0.2) +
  labs(title ="Boxplot of the length of eggs per type",
       y = "length (mm)",
       x = "type") +
* stat_summary(fun=mean, geom="point", shape=10,
*              size=2, color="black", fill="black")
```
]
 
.panel2-boxplot-auto[
&lt;img src="Day22_files/figure-html/boxplot_auto_07_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Side-by-side Boxplot (1a)
.panel1-boxplot-auto[

```r
cuckoo %&gt;%
  ggplot(aes(x=type,y=length,fill=type)) +
  theme_bw() +
  geom_boxplot() +
  geom_jitter(width = 0.2) +
  labs(title ="Boxplot of the length of eggs per type",
       y = "length (mm)",
       x = "type") +
  stat_summary(fun=mean, geom="point", shape=10,
               size=2, color="black", fill="black") +
* theme(plot.title = element_text(hjust=0.5, size=9,
*                                 face='bold'))
```
]
 
.panel2-boxplot-auto[
&lt;img src="Day22_files/figure-html/boxplot_auto_08_output-1.svg" width="100%" /&gt;
]

&lt;style&gt;
.panel1-boxplot-auto {
  color: black;
  width: 49%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 70%
}
.panel2-boxplot-auto {
  color: black;
  width: 49%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 70%
}
.panel3-boxplot-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 70%
}
&lt;/style&gt;



.scroll-box-20[

]

---

class: middle

# Check Assumptions (1b)

.blockquote[
`$$H_0: \text{The mean egg length is equal between the different bird tpyes.}$$`
`$$H_a: \text{The mean egg length for at least one bird type is different }$$`

Make sure that all assumptions for ANOVA are met:

- The data (length) must be normally distributed (in all groups)
- The variability within all groups is similar
]

---

count: false
 
## Approximate normality in groups (1b)
.panel1-normality-auto[

```r
*cuckoo
```
]
 
.panel2-normality-auto[

```
    length type
1    21.73    1
2    21.73    1
3    23.99    1
4    22.44    1
5    22.97    1
6    20.88    1
7    22.53    1
8    22.09    1
9    24.17    1
10   23.85    1
11   22.99    1
12   20.00    1
13   20.55    1
14   22.42    1
15   20.24    1
16   24.24    1
17   22.91    1
18   19.60    1
19   21.69    1
20   22.88    1
21   23.87    1
22   24.18    1
23   23.33    1
24   19.92    1
25   25.88    1
26   24.16    1
27   21.71    1
28   17.69    1
29   23.11    1
30   20.92    1
31   23.74    1
32   22.93    1
33   24.92    1
34   23.47    1
35   18.68    1
36   21.99    1
37   23.20    1
38   23.70    1
39   25.53    1
40   23.26    1
41   24.63    1
42   24.12    1
43   20.09    1
44   21.79    1
45   21.05    2
46   21.85    2
47   22.05    2
48   22.45    2
49   22.65    2
50   23.25    2
51   23.25    2
52   23.25    2
53   23.45    2
54   23.45    2
55   23.65    2
56   23.85    2
57   24.05    2
58   24.05    2
59   24.05    2
60   20.85    3
61   21.65    3
62   22.05    3
63   22.85    3
64   23.05    3
65   23.05    3
66   23.05    3
67   23.05    3
68   23.45    3
69   23.85    3
70   23.85    3
71   23.85    3
72   24.05    3
73   25.05    3
74   21.05    4
75   21.85    4
76   22.05    4
77   22.05    4
78   22.05    4
79   22.25    4
80   22.45    4
81   22.45    4
82   22.65    4
83   23.05    4
84   23.05    4
85   23.05    4
86   23.05    4
87   23.05    4
88   23.25    4
89   23.85    4
90   21.05    5
91   21.85    5
92   21.85    5
93   21.85    5
94   22.05    5
95   22.45    5
96   22.65    5
97   23.05    5
98   23.05    5
99   23.25    5
100  23.45    5
101  24.05    5
102  24.05    5
103  24.05    5
104  24.85    5
105  19.85    6
106  20.05    6
107  20.25    6
108  20.85    6
109  20.85    6
110  20.85    6
111  21.05    6
112  21.05    6
113  21.05    6
114  21.25    6
115  21.45    6
116  22.05    6
117  22.05    6
118  22.05    6
119  22.25    6
```
]

---
count: false
 
## Approximate normality in groups (1b)
.panel1-normality-auto[

```r
cuckoo %&gt;%
* ggplot(aes(sample=length))
```
]
 
.panel2-normality-auto[
&lt;img src="Day22_files/figure-html/normality_auto_02_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Approximate normality in groups (1b)
.panel1-normality-auto[

```r
cuckoo %&gt;%
  ggplot(aes(sample=length)) +
* geom_qq()
```
]
 
.panel2-normality-auto[
&lt;img src="Day22_files/figure-html/normality_auto_03_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Approximate normality in groups (1b)
.panel1-normality-auto[

```r
cuckoo %&gt;%
  ggplot(aes(sample=length)) +
  geom_qq() +
* geom_qq_line()
```
]
 
.panel2-normality-auto[
&lt;img src="Day22_files/figure-html/normality_auto_04_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Approximate normality in groups (1b)
.panel1-normality-auto[

```r
cuckoo %&gt;%
  ggplot(aes(sample=length)) +
  geom_qq() +
  geom_qq_line() +
* facet_grid(~type)
```
]
 
.panel2-normality-auto[
&lt;img src="Day22_files/figure-html/normality_auto_05_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Approximate normality in groups (1b)
.panel1-normality-auto[

```r
cuckoo %&gt;%
  ggplot(aes(sample=length)) +
  geom_qq() +
  geom_qq_line() +
  facet_grid(~type) +
* theme_bw()
```
]
 
.panel2-normality-auto[
&lt;img src="Day22_files/figure-html/normality_auto_06_output-1.svg" width="100%" /&gt;
]

&lt;style&gt;
.panel1-normality-auto {
  color: black;
  width: 49%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 70%
}
.panel2-normality-auto {
  color: black;
  width: 49%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 70%
}
.panel3-normality-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 70%
}
&lt;/style&gt;



.scroll-output[


]

---

# Fitting ANOVA (1c)


```r
fit_anova &lt;- aov(length~type, cuckoo)
summary(fit_anova)
```

```
             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
*type          5  41.12   8.223   4.713 0.000602 ***
Residuals   113 197.18   1.745                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

--

.blockquote[
Since the .bold[p-value] is very small, at the significance level of `\(5\%\)`, we have sufficient evidence to conclude that the mean egg length for at least one bird type is .bold[different] from the mean egg length in at least one other bird type.
]

--

.out-t.font120[But which of the species are different?]

---

class: middle

# Inference after ANOVA

.blockquote.font80[
- Compute a CI for any `\(\mu_i\)`

- Compute a CI for `\(\mu_i - \mu_j\)`

- Pairwise t-test for difference in means

`$$H_0: \mu_i = \mu_j \text{ vs. } H_a: \mu_i \neq \mu_j$$`

- Use the usual procedures except:

    - Estimate any `\(\sigma\)` with the pooled standard deviation: `\(\sqrt{MSE}\)`
    - Use the error degrees of freedom for any t-values
]

---

class: middle

# Inference after ANOVA

.blockquote.font90[
Compute a CI for any `\(\mu_i\)`

- The usual procedure:

`$$\bar{x}_i \pm t^{*} \frac{s_i}{\sqrt{n_i}}$$`
- .bold[BUT] after .bold[ANOVA], estimate any `\(\sigma\)` with the pooled standard deviation:

`$$\bar{x}_i \pm t^{*}\frac{\sqrt{MSE}}{\sqrt{n_i}}$$`

  - the corresponding `df=n-k`
]

---

# Cuckoo Eggs (1d)

&gt; Find a 95% confidence interval for the mean cuckoo egg length in `European robin` nests (Type = 4).

.pull-left[
.font80[

```r
MSE &lt;- 1.745
summary(fit_anova)
```

```
             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
type          5  41.12   8.223   4.713 0.000602 ***
Residuals   113 197.18   1.745                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```
]
]
.pull-right[
.font80[

|Type |     mean|        sd|  n|
|:----|--------:|---------:|--:|
|1    | 22.51636| 1.8058292| 44|
|2    | 23.09000| 0.9014274| 15|
|3    | 23.12143| 1.0687365| 14|
|4    | 22.57500| 0.6845923| 16|
|5    | 22.90333| 1.0676186| 15|
|6    | 21.13000| 0.7437357| 15|
]
]

`$$\bar{x}_i \pm t^{*}\frac{\sqrt{MSE}}{\sqrt{n_i}}, \text{ df = n-k }$$`

---

# Inferences after ANOVA

Compute a CI for any `\(\mu_i - \mu_j\)`

.blockquote.font90[

- The usual procedure:

`$$(\bar{x}_i - \bar{x}_j) \pm t^{*} \sqrt{\frac{s_i^2}{n_i} + \frac{s_j^2}{n_j}}$$`

- BUT after ANOVA, estimate any `\(\sigma\)` with the pooled standard deviation:

`$$(\bar{x}_i - \bar{x}_j) \pm t^{*} \sqrt{MSE \left(\frac{1}{n_i} + \frac{1}{n_j}\right)}$$`
  - the corresponding `df=n-k`
]

---

# Cuckoo Eggs (1e)

Find a 95% CI for the difference in mean egg length between `European robin`(type = 4) and `Eurasian wren`(type = 6) nests.

.pull-left-60[

.font80[

```
             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
type          5  41.12   8.223   4.713 0.000602 ***
Residuals   113 197.18   1.745                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```
]
]
.pull-right-40[
.font80[

|Type |     mean|        sd|  n|
|:----|--------:|---------:|--:|
|1    | 22.51636| 1.8058292| 44|
|2    | 23.09000| 0.9014274| 15|
|3    | 23.12143| 1.0687365| 14|
|4    | 22.57500| 0.6845923| 16|
|5    | 22.90333| 1.0676186| 15|
|6    | 21.13000| 0.7437357| 15|
]
]

`$$(22.575 - 21.130) \pm 1.981 \cdot \sqrt{1.745\left(\frac{1}{16} + \frac{1}{15} \right)} = (0.50, 2.39)$$`
.code80[

```r
(stat[4,2] - stat[6,2]) + c(-1,1)* (qt(1-0.05/2, df=113))* sqrt(MSE*(1/stat[4,4] + 1/stat[6,4]))
[1] 0.5044174 2.3855826
```
]

--

.out-t.font80[Why is it important that the interval contains only positive values?]


---

# Cuckoo Eggs (1f)

.blockquote.font80[Find a 95% CI for the difference in mean egg length between `Dunnock` (type = 3) and `European robin`(type = 4)  nests.]

.pull-left-60[
.font80[

```
             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
type          5  41.12   8.223   4.713 0.000602 ***
Residuals   113 197.18   1.745                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```
]
]
.pull-right-40[
.font80[

|Type |     mean|        sd|  n|
|:----|--------:|---------:|--:|
|1    | 22.51636| 1.8058292| 44|
|2    | 23.09000| 0.9014274| 15|
|3    | 23.12143| 1.0687365| 14|
|4    | 22.57500| 0.6845923| 16|
|5    | 22.90333| 1.0676186| 15|
|6    | 21.13000| 0.7437357| 15|
]
]

.code80[

```r
(stat[3,2] - stat[4,2]) + c(-1,1)* (qt(1-0.05/2, df=113))*sqrt(MSE*(1/stat[3,4] + 1/stat[4,4]))
[1] -0.4113351  1.5041922
```
]

`$$(23.121 - 22.575) \pm 1.981\cdot \sqrt{1.188\left(\frac{1}{14} + \frac{1}{16} \right)} = (-0.41, 1.50)$$`

--

.out-t.font80[What does it mean if the interval contains 0?]

---

# Mutiple Comparisons 

.blockquote.font90[

- Often, doing pairwise comparisons after ANOVA involves many tests

  - e.g. `\(k\)` groups/categories,then we have `\(\frac{k(k-1)}{2}\)` comparisons
  - `\(k=6\)` bird species then 15 pairwise tests.

- If each test has an `\(\alpha\)` chance of a Type I error (finding a difference between a pair that aren’t different),  the overall Type I error rate can be much higher.

  - Use a smaller `\(\alpha\)` for each pairwise test (Bonferroni)
    - `\(\alpha^{*} = \frac{\alpha}{k}\)`
    - e.g `\(\alpha = 0.05\)` and `\(k = 6\)`, then `\(\alpha^{*} = 0.05/6 =  0.0083\)`
]
---

# Cuckoo Eggs (1g)

- Which means are “different” at a `\(5\%\)` significance level?


```r
pairwise.t.test(cuckoo$length, cuckoo$type, p.adjust.method =  "bonferroni")
```

```

	Pairwise comparisons using t tests with pooled SD 

data:  cuckoo$length and cuckoo$type 

  1      2      3      4      5     
2 1.0000 -      -      -      -     
3 1.0000 1.0000 -      -      -     
4 1.0000 1.0000 1.0000 -      -     
5 1.0000 1.0000 1.0000 1.0000 -     
6 0.0097 0.0013 0.0014 0.0436 0.0055

P value adjustment method: bonferroni 
```

---

# Multiple Comparisons (1h)

.pull-left-40[
.code80[

```r
library(multcomp, quietly = TRUE)
fit &lt;- lm(length~type, cuckoo)
mcp &lt;- glht(fit, linfct = mcp(type = "Tukey"))
summary(mcp)
```
]
]
.pull-right-60[
.code70[

```

	 Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: lm(formula = length ~ type, data = cuckoo)

Linear Hypotheses:
           Estimate Std. Error t value Pr(&gt;|t|)   
2 - 1 == 0  0.57364    0.39495   1.452  0.68910   
3 - 1 == 0  0.60506    0.40534   1.493  0.66358   
4 - 1 == 0  0.05864    0.38564   0.152  0.99999   
5 - 1 == 0  0.38697    0.39495   0.980  0.92127   
6 - 1 == 0 -1.38636    0.39495  -3.510  0.00816 **
3 - 2 == 0  0.03143    0.49089   0.064  1.00000   
4 - 2 == 0 -0.51500    0.47475  -1.085  0.88345   
5 - 2 == 0 -0.18667    0.48235  -0.387  0.99880   
6 - 2 == 0 -1.96000    0.48235  -4.063  0.00127 **
4 - 3 == 0 -0.54643    0.48342  -1.130  0.86431   
5 - 3 == 0 -0.21810    0.49089  -0.444  0.99768   
6 - 3 == 0 -1.99143    0.49089  -4.057  0.00123 **
5 - 4 == 0  0.32833    0.47475   0.692  0.98196   
6 - 4 == 0 -1.44500    0.47475  -3.044  0.03283 * 
6 - 5 == 0 -1.77333    0.48235  -3.676  0.00462 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- single-step method)
```
]
]

---

class: action

# &lt;i class="fa fa-pencil-square-o" style="font-size:48px;color:purple"&gt;&amp;nbsp;Your&amp;nbsp;Turn&amp;nbsp;1&lt;/i&gt;    

.pull-left-40[
![](https://media.giphy.com/media/RKApDdwsQ6jkwd6RNn/giphy.gif)
]
.pull-right-60[

&lt;br&gt;
&lt;br&gt;

.blockquote[
- Go over to the in class activity file
- Complete the remaining activity 
]
]

<div class="countdown" id="timer_62850d6d" style="top:0;right:0;padding:3px 4px;font-size:2em;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="libs/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "googlecode",
"highlightLines": true,
"highlightLanguage": ["r", "css", "yaml"],
"countIncrementalSlides": true,
"slideNumberFormat": "%current%",
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
