---
title: "Observations and Experiments"
subtitle: "<br/> STAT 120"
author: "Bastola"
date: "`r format(Sys.Date(), ' %B %d %Y')`"
output:
  xaringan::moon_reader:
    css: ["default", css/xaringan-themer-solns.css,  css/my-font.css]
    lib_dir: libs
    chakra: libs/remark-latest.min.js
    seal: false
    nature:
      highlightStyle: googlecode  #http://arm.rbind.io/slides/xaringan.html#77 # idea, magula
      highlightLines: true
      highlightLanguage: ["r", "css", "yaml"]
      countIncrementalSlides: true
      slideNumberFormat: "%current%"
      titleSlideClass: ["left", "middle", "inverse"]
      ratio: "16:9"
    includes:
      in_header: header.html  
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
options(htmltools.preserve.raw = FALSE)
options(ggrepel.max.overlaps = Inf)

knitr::opts_chunk$set(echo = TRUE, 
                      dev = 'svg',
                      collapse = TRUE, 
                      comment = NA,  # PRINTS IN FRONT OF OUTPUT, default is '##' which comments out output
                      prompt = FALSE, # IF TRUE adds a > before each code input
                      warning = FALSE, 
                      message = FALSE,
                      fig.height = 3, 
                      fig.width = 4,
                      out.width = "100%"
                      )



# load necessary packages
library(Sleuth3)   # Data-set for Sleuth
library(tidyverse)
library(countdown)
library(mosaic)
library(ggthemes)
library(xaringanExtra)
library(forcats)
#library(NHSRtheme)  # color themes, nhs
xaringanExtra::use_panelset()
xaringanExtra::use_tachyons()
xaringanExtra::use_clipboard()
xaringanExtra::use_extra_styles(
  hover_code_line = TRUE,         #<<
  mute_unhighlighted_code = TRUE  #<<
)
library(flipbookr)
library(patchwork)


# Set ggplot theme
theme_set(theme_tufte(base_size = 10))


yt <- 0


```



```{r xaringanExtra-clipboard, echo=FALSE}
htmltools::tagList(
  xaringanExtra::use_clipboard(
    button_text = "<i class=\"fa fa-clipboard\"></i>",
    success_text = "<i class=\"fa fa-check\" style=\"color: #90BE6D\"></i>",
    error_text = "<i class=\"fa fa-times-circle\" style=\"color: #F94144\"></i>"
  ),
  rmarkdown::html_dependency_font_awesome()
)
```


layout: true
  
<!-- <div class="my-footer"><span>Stat 230</span></div> -->
<!-- this adds the link footer to all slides, depends on my-footer class in css-->

---

class: title-slide, middle
<!-- background-image: url("assets/title-image2.jpg") -->
background-position: 10% 90%, 100% 50%
background-size: 160px, 100% 100%

# .fancy[ Experiments and Observational Studies]

### .fancy[Stat 120]

`r format(Sys.Date(), ' %B %d %Y')`

---

# Association and Causation


.bql[Two variables are .b[associated] if values of one variable tends to
be related to values of the other variable
- e.g. .green-h[Families with many cars tend to own many television sets]
]

--

<br>

.bql[Two variables are .b[causally associated] if changing the value of
the explanatory variable influences the value of the response
variable
- e.g. .green-h[Studies show that taking a practice exam increases your score on an exam]
]

---

# College Education and Aging

.bql[
.font80[
“Education seems to be an elixir that can bring us a healthy body and mind
throughout adulthood and even a longer life,” says Margie E. Lachman, a psychologist
at Brandeis University who specializes in aging. “For those in midlife and beyond, a
college degree appears to slow the brain’s aging process by up to a decade, adding a
new twist to the cost-benefit analysis of higher education - for young students as
well as those thinking about returning to school.”]]



Which of the following is true?

.bql.font80[
1. Explanatory Variable = brain aging; Response Variable = elixir
2. Explanatory Variable = brain aging; Response Variable = college
degree
3. Explanatory Variable = college degree; Response Variable = brain
aging
]

<details>
<summary class="answer">Click for answer</summary>
The correct answer is 3.
</details>


.footnote[A Sharper Mind, Middle Age and Beyond, NY Times, 1/19/12]

---

class: middle

# College Education and Aging

.bqt[Based on this passage, should we conclude that obtaining a college
degree causes a slowdown in the brain’s aging process?
- Yes
- No
]

<details>
<summary class="answer">Click for answer</summary>
No. There could be other factors, such as socioeconomic status, lifestyle choices, or genetic predispositions, that contribute to both higher education attainment and slower brain aging
</details>

---

# Should you buy more TVs to live longer?


```{r, echo=FALSE, out.width="65%", fig.align='center'}
# Generate data frame
df <- data.frame(Country = c("United States", "China", "India", "Japan", "Germany", "United Kingdom", "France", "Brazil", "Italy", "Russia", "Canada", "South Korea", "Spain", "Australia", "Mexico", "Indonesia", "Nigeria", "Turkey", "Iran", "Thailand", "Egypt", "Vietnam", "South Africa", "Philippines", "Poland", "Ukraine", "Bangladesh", "Greece", "Portugal", "Sweden"),
                  Life_Expectancy = c(78.7, 76.4, 68.3, 84.2, 81.2, 81.1, 82.8, 75.2, 82.7, 72.2, 82.2, 82.6, 82.8, 82.8, 76.9, 71.5, 54.2, 77.2, 74.3, 75.2, 72.2, 75.2, 68.2, 67.3, 78.2, 76.2, 72.2, 74.2, 81.2, 81.2),
                  TVs_per_1000 = c(871.2, 463.2, 82.3, 645.2, 745.2, 745.2, 645.2, 463.2, 545.2, 463.2, 871.2, 745.2, 645.2, 871.2, 463.2, 82.3, 54.2, 463.2, 82.3, 463.2, 54.2, 82.3, 54.2, 72.3, 645.2, 545.2, 82.3, 463.2, 745.2, 745.2))


library(ggrepel)
library(ggthemes)

ggplot(data = df, aes(x = TVs_per_1000, y = Life_Expectancy)) +
  geom_point(aes(color = Country), size = 3) +
  geom_text_repel(aes(label = Country), size = 2, max.overlaps = getOption("ggrepel.max.overlaps", default = 10),
  nudge_x = 1,
  nudge_y = .3,) +
  geom_smooth(method = "lm", se = FALSE) +
  theme(plot.title = element_text(hjust = 0.5)) +
  annotate("text", x=700, y=60, label=paste("r=", round(cor(df$TVs_per_1000, df$Life_Expectancy),2))) +
  theme_tufte() +
  theme(legend.position = "none") 
```



---

class: middle

# TVs and Life Expectancy

<center>
<img src="images/confounding.png" width="70%" height="60%"> <br>
<a>Extra lurking variable</a>
</center>

---


class: middle

# Confounding Variable

.bq.font100[
A third variable that is associated with both the explanatory
variable and the response variable is called a .b[confounding variable]
- A confounding variable can offer a plausible explanation for an association between the two variables.
]
<br>

.blue-h[Whenever confounding variables are present (or may be present), a causal association .b[CANNOT] be determined!]


---

<br>
<br>
<br>

# Experiment Vs Observational Study

.font120.bq[
An .out-t.b[observational study] is a study in which the researcher does
not actively control the value of any variable, but simply
observes the values as they naturally exist
]

--
<br>

.font120.bq[
An .out-t.b[experiment] is a study in which the researcher actively
controls one or more of the explanatory variables
]

---


class: middle

# Experiment or Observational Study?

.bq[
To examine whether farm-grown salmon contain more omega-3 oils
if water is more acidic, we collect samples of salmon and water from
multiple fish farms to see if the two variables are related.

- Experiment
- Observational Study
]

<details>
<summary class="answer">Click for answer</summary>
This is an observational study because the researchers do not actively manipulate or control the acidity of the water; they simply observe the naturally occurring conditions at each fish farm.
</details>

---

class: middle

# Observational Studies and Confounding Variable

.bql[
- There are almost always confounding variables in observational
studies

- Observational studies can almost never be used to establish
causation!!
]


.blue-h[To avoid confounding variables: Randomly assign values of the explanatory variable!]


---

class: middle

# Randomized Experiments

<center>
<img src="images/basic_randomization.png" width="70%" height="50%"> <br>
</center>

.footnote[Source: click [here](https://bookdown.org/jgscott/DSGI/experiments.html)]

---

class: middle

# Randomized Experiments

.bql[
- In a .b[randomized experiment], the explanatory variable for each
unit is determined randomly, before the response variable is
measured

- The different levels of the explanatory variable are known as
.b[treatments]

  - Randomly divide the units into groups, and randomly assign a
different treatment to each group
  - Observe the response variable after treatments are applied
]

---


# Elimination of confounding variables

<center>
<img src="images/randomized_experiments.png" width="70%" height="60%"> <br>
</center>

--


.out-t[Because the explanatory variable is randomly assigned, it is not associated with any other variables.  Confounding variables are eliminated!!!]

---


# Exercise and the Brain

.bql[
- A sample of mice were divided randomly into two groups. One
group was given access to an exercise wheel, the other group
was kept sedentary
- "The brains of mice and rats that were allowed to run on wheels
pulsed with vigorous, newly born neurons, and those animals
then breezed through mazes and other tests of rodent IQ"
compared to the sedentary mice
]

.footnote[Reynolds, "Phys Ed: Your Brain on Exercise", NY Times, July 7, 2010]


---

# Exercise and the Brain

.bql[
- A sample of mice were divided randomly into two groups. One
group was given access to an exercise wheel, the other group
was kept sedentary
- "The brains of mice and rats that were allowed to run on wheels
pulsed with vigorous, newly born neurons, and those animals
then breezed through mazes and other tests of rodent IQ"
compared to the sedentary mice
]



.hljs[Is this evidence that exercise causes an increase in brain
activity and IQ, at least in mice?]

.footnote[Reynolds, "Phys Ed: Your Brain on Exercise", NY Times, July 7, 2010]

---

# Exercise and the Brain

.bql[
- A sample of mice were divided randomly into two groups. One
group was given access to an exercise wheel, the other group
was kept sedentary
- "The brains of mice and rats that were allowed to run on wheels
pulsed with vigorous, newly born neurons, and those animals
then breezed through mazes and other tests of rodent IQ"
compared to the sedentary mice
]



.hljs[Is this evidence that exercise causes an increase in brain
activity and IQ, at least in mice?]


.center.out-t[Randomized experiment can yield causal conclusions!]


.footnote[Reynolds, "Phys Ed: Your Brain on Exercise", NY Times, July 7, 2010]

---


# Knee Surgery, Control Groups

.bql[### Study Context

- Researchers investigated the effectiveness of knee surgery for arthritis.
- Patients who underwent surgery reported less pain.
]

<br>
--

.bql[### The Importance of a Control Group

- To validate if the surgery was effective, a control group received a fake knee surgery.
- Results were indistinguishable between the control and treatment groups.
]

---


# Control Group

.bq[
### Placebo Effect
- Control groups often get a placebo to measure the effect.
- It is estimated that 75% of the effectiveness of anti-depressant medication is due to the placebo effect.
]

--

<br>

.bqt.font90[
**Question:** Is this evidence that the surgery causes a decrease in pain?  
**Answer:** No, control group results indicate that the placebo effect might be at play.
]

.footnote[Source: The Placebo Prescription, NY Times Magazine, 1/9/00]

---

class: middle

# Double-blinded Experiments

> Nobody knows who gets what, not even the researchers.

<br>
.bq.font80[Example: A new pill for blood pressure

- Some people get the real pill, others a fake.
- Both pills look the same so no one can tell.
- Researchers checking results don't know either, so it's fair.]



---

class: middle

# Randomized Experiments Types: `randomized comparative experiment`

.bql[
- Individuals are randomly assigned to a treatment or control group. 
- Most effective when the investigator has no prior knowledge of the individuals who are part of the experiment. 
]

.blue-h[Example: A researcher randomly assigns participants to either a drug treatment group or a control group to measure the effectiveness of the drug.]

---

class: middle

# Randomized Experiments Types: `matched pairs experiment`


.bql[
- Each individual in the experimental group is matched with an individual in the control group based on a specific criterion. 
- Most effective when the investigator has prior knowledge of the individuals involved in the experiment.
]

.blue-h[Example: A researcher matches participants based on age, gender, and education level, then assigns one participant in the matched pair to the drug treatment group and the other to the control group to measure the effectiveness of the drug.]

---

# Variations of matched pairs experiments: `Effectiveness of a training program`

.pull-left[## Before-After Test: 
.bq.font80[
- Measure everyone's skill level before any training.

  - .b[Example:] Time each runner's 100m sprint.
  
- Train only one group.

- Measure again and compare.

  - .b[Example:] Time the 100m sprint again and see who improved more.
]
]
.pull-right[## Two-Times Test: 
.bq.font80[
- Everyone gets both training and no training, but in random order.

  - .b[Example:] Flip a coin to decide who gets training first.
  
- Measure skill after each.

  - .b[Example:] Time each 100m sprint after both.
  
- Compare the same person's times to see which training worked.
]
]


.footnote[[Sha’Carri Richardson wins 100-meter title](https://apnews.com/article/richardson-shacarri-world-championships-sprint-90b630b89309a85c37f08d9c787811ec)]

<!--
In the provided example, the "matching" comes from using the same individual to represent both the "before" and "after" states in the experiments. In paired designs, each subject essentially serves as their own control, which is a form of matching.

Before-After Test: The matching here is temporal; the same individual's sprint time is measured before and after the training. By comparing these two measurements for each individual, the paired design accounts for many of the other variables that might affect sprint time, since each person serves as their own baseline or control.

Two-Times Test (Repeated Measures): In this design, each individual undergoes both conditions (training and no training). The matching here is again based on the individual: the same person's performance under both conditions is compared. By doing so, the design controls for subject-specific variables.

In both designs, the pairing or matching occurs at the level of the individual subject, reducing the impact of between-subject variability and thereby often providing a more precise estimate of the treatment effect.


In summary, the choice between the two designs depends on the complexity of the research question, the limitations in resources, and the specific confounding variables that the experiment aims to control for.

-->


---

class: action, middle

# <i class="fa fa-pencil-square-o" style="font-size:48px;color:purple">&nbsp;Group&nbsp;Work&nbsp;`r (yt <- yt + 1)`</i>    


.pull-left-40[
![](https://media.giphy.com/media/RKApDdwsQ6jkwd6RNn/giphy.gif)
]

.pull-right-60[
<br>
<br>
.bq.font90[

- Let's head over to [course helper page](https://stat120-winter24.netlify.app/) to see some case studies
- Then we will work on a class activity
- Submit the class activity by the deadline
]
]


`r countdown(minutes = 15, seconds = 00, top = 0 , color_background = "inherit", padding = "3px 4px", font_size = "2em")`

