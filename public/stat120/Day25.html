<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Post-ANOVA</title>
    <meta charset="utf-8" />
    <meta name="author" content="Bastola" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <link href="libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"Copy Code","success":"Copied!","error":"Press Ctrl+C to Copy"})</script>
    <link href="libs/xaringanExtra-extra-styles/xaringanExtra-extra-styles.css" rel="stylesheet" />
    <script>window.xaringanExtraClipboard(null, {"button":"<i class=\"fa fa-clipboard\"><\/i>","success":"<i class=\"fa fa-check\" style=\"color: #90BE6D\"><\/i>","error":"<i class=\"fa fa-times-circle\" style=\"color: #F94144\"><\/i>"})</script>
    <link href="libs/font-awesome/css/all.min.css" rel="stylesheet" />
    <link href="libs/font-awesome/css/v4-shims.min.css" rel="stylesheet" />
    <link href="libs/countdown/countdown.css" rel="stylesheet" />
    <script src="libs/countdown/countdown.js"></script>
    <script src="https://use.fontawesome.com/5235085b15.js"></script>

    <link rel="stylesheet" href="css/xaringan-themer-solns.css" type="text/css" />
    <link rel="stylesheet" href="css/my-theme.css" type="text/css" />
    <link rel="stylesheet" href="css/my-font.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">








layout: true
  
---

class: title-slide, middle

# .fancy[Post-ANOVA]

### .fancy[Stat 120]

 October 29 2023

---

class: middle

# Post-ANOVA

.bql.font90[ Inference .b[AFTER] doing .b[ANOVA] to compare means for several groups:
- Confidence interval for a single mean
- Confidence interval for a difference in two means
- Pairwise t-test for a difference in two means
- Multiple comparisons
]

---

class: middle

# ANOVA for Difference in Means

.bqt.font90[.b[Data:] Random samples of size `\(n_1, n_2, \cdots , n_k\)` from each of k populations (or groups)

.b[Summary statistics:]

  - Sample mean for each group
  - Std. dev. for each group
  - Mean and std. dev. for all values
]

---

class: middle

# ANOVA for Difference in Means

.bql[
`$$H_0:\mu_1 = \mu_2 = \cdots = \mu_k$$`
`$$H_a: \text{at least one } \mu_i \text{ is different}$$`

- .bold[Conditions:] Similar variability AND either sample sizes in each group are large (each `\(n_i \geq 30\)`) OR the data are relatively normally distributed
]

---


# Cuckoo Birds

.pull-left-60[
.bql.font80[
- Cuckoo birds lay their eggs in the nests of other birds

- When the cuckoo baby hatches, it kicks out all the original eggs/babies

- If the cuckoo is lucky, the mother will raise the cuckoo as if it were her own
]
]

.pull-right-40[
&lt;br&gt;
&lt;br&gt;
&lt;center&gt;
&lt;img src="images/cuckoo.jpg" width="80%" height="80%"&gt; &lt;br&gt;
&lt;a&gt;Cuckoo bird in nest&lt;/a&gt;&lt;br&gt;
&lt;/center&gt;
&lt;br&gt;
]

--

.green-h.font110[Do cuckoo bird eggs found in nests of different species differ in size?]

---

class: middle

# Cuckoo Dataset

.pull-left[
.bql.font80[
- .bold[cuckoo] dataset contains information on 120 Cuckoo eggs, obtained from randomly selected "foster" nests.

- researchers have measured the `length` (in mm) and established the `type` (species) of foster parent.
]

]
.pull-right[
.bq.font80[
- `Species=1`: Hedge Sparrow
- `Species=2`: Meadow Pit
- `Species=3`: Pied Wagtail
- `Species=4`: European Robin
- `Species=5`: Tree Pipit
- `Species=6`: Eurasian Wren

]

]

---

class: inverse, middle

.b.large.bql[Goal: test if the type of foster parent has an effect on the average length of the cuckoo eggs.]

---

count: false
 
## ANOVA
.panel1-cuckoo-auto[

```r
*library(dplyr)
```
]
 
.panel2-cuckoo-auto[

]

---
count: false
 
## ANOVA
.panel1-cuckoo-auto[

```r
library(dplyr)
*Cuckoo &lt;- read.csv("https://raw.githubusercontent.com/deepbas/stat120datasets/main/cuckoos.csv")
```
]
 
.panel2-cuckoo-auto[

]

---
count: false
 
## ANOVA
.panel1-cuckoo-auto[

```r
library(dplyr)
Cuckoo &lt;- read.csv("https://raw.githubusercontent.com/deepbas/stat120datasets/main/cuckoos.csv")
*Cuckoo &lt;- Cuckoo
```
]
 
.panel2-cuckoo-auto[

]

---
count: false
 
## ANOVA
.panel1-cuckoo-auto[

```r
library(dplyr)
Cuckoo &lt;- read.csv("https://raw.githubusercontent.com/deepbas/stat120datasets/main/cuckoos.csv")
Cuckoo &lt;- Cuckoo %&gt;%
* mutate(species = as.factor(species))  # change species to a categorical variable
```
]
 
.panel2-cuckoo-auto[

]

---
count: false
 
## ANOVA
.panel1-cuckoo-auto[

```r
library(dplyr)
Cuckoo &lt;- read.csv("https://raw.githubusercontent.com/deepbas/stat120datasets/main/cuckoos.csv")
Cuckoo &lt;- Cuckoo %&gt;%
  mutate(species = as.factor(species))  # change species to a categorical variable

*stat &lt;- Cuckoo
```
]
 
.panel2-cuckoo-auto[

]

---
count: false
 
## ANOVA
.panel1-cuckoo-auto[

```r
library(dplyr)
Cuckoo &lt;- read.csv("https://raw.githubusercontent.com/deepbas/stat120datasets/main/cuckoos.csv")
Cuckoo &lt;- Cuckoo %&gt;%
  mutate(species = as.factor(species))  # change species to a categorical variable

stat &lt;- Cuckoo %&gt;%
* group_by(species)   # group by type
```
]
 
.panel2-cuckoo-auto[

]

---
count: false
 
## ANOVA
.panel1-cuckoo-auto[

```r
library(dplyr)
Cuckoo &lt;- read.csv("https://raw.githubusercontent.com/deepbas/stat120datasets/main/cuckoos.csv")
Cuckoo &lt;- Cuckoo %&gt;%
  mutate(species = as.factor(species))  # change species to a categorical variable

stat &lt;- Cuckoo %&gt;%
  group_by(species) %&gt;%  # group by type
* summarize(mean = mean(length),
*           sd = sd(length),
*           n = length(length))
```
]
 
.panel2-cuckoo-auto[

]

---
count: false
 
## ANOVA
.panel1-cuckoo-auto[

```r
library(dplyr)
Cuckoo &lt;- read.csv("https://raw.githubusercontent.com/deepbas/stat120datasets/main/cuckoos.csv")
Cuckoo &lt;- Cuckoo %&gt;%
  mutate(species = as.factor(species))  # change species to a categorical variable

stat &lt;- Cuckoo %&gt;%
  group_by(species) %&gt;%  # group by type
  summarize(mean = mean(length),
            sd = sd(length),
            n = length(length)) %&gt;%
* as.data.frame()
```
]
 
.panel2-cuckoo-auto[

]

---
count: false
 
## ANOVA
.panel1-cuckoo-auto[

```r
library(dplyr)
Cuckoo &lt;- read.csv("https://raw.githubusercontent.com/deepbas/stat120datasets/main/cuckoos.csv")
Cuckoo &lt;- Cuckoo %&gt;%
  mutate(species = as.factor(species))  # change species to a categorical variable

stat &lt;- Cuckoo %&gt;%
  group_by(species) %&gt;%  # group by type
  summarize(mean = mean(length),
            sd = sd(length),
            n = length(length)) %&gt;%
  as.data.frame()
*knitr::kable(stat)
```
]
 
.panel2-cuckoo-auto[

|species       |     mean|        sd|  n|
|:-------------|--------:|---------:|--:|
|hedge.sparrow | 23.11429| 1.0494373| 14|
|meadow.pipit  | 22.29333| 0.9195849| 45|
|pied.wagtail  | 22.88667| 1.0722917| 15|
|robin         | 22.55625| 0.6821229| 16|
|tree.pipit    | 23.08000| 0.8800974| 15|
|wren          | 21.12000| 0.7542262| 15|
]

&lt;style&gt;
.panel1-cuckoo-auto {
  color: black;
  width: 58.8%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 70%
}
.panel2-cuckoo-auto {
  color: black;
  width: 39.2%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 70%
}
.panel3-cuckoo-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 70%
}
&lt;/style&gt;





---

count: false
 
## Side-by-side Boxplot (1a)
.panel1-boxplot-auto[

```r
*Cuckoo
```
]
 
.panel2-boxplot-auto[

```
      X length breadth       species  id
1     1   21.7    16.1  meadow.pipit  21
2     2   22.6    17.0  meadow.pipit  22
3     3   20.9    16.2  meadow.pipit  23
4     4   21.6    16.2  meadow.pipit  24
5     5   22.2    16.9  meadow.pipit  25
6     6   22.5    16.9  meadow.pipit  26
7     7   22.2    17.3  meadow.pipit  27
8     8   24.3    16.8  meadow.pipit  28
9     9   22.3    16.8  meadow.pipit  29
10   10   22.6    17.0  meadow.pipit  30
11   11   20.1    16.5  meadow.pipit  31
12   12   22.0    16.9  meadow.pipit  32
13   13   22.8    16.5  meadow.pipit  33
14   14   22.0    17.0  meadow.pipit  34
15   15   22.4    17.0  meadow.pipit  35
16   16   22.3    16.3  meadow.pipit  36
17   17   20.6    16.2  meadow.pipit  37
18   18   22.1    16.8  meadow.pipit  38
19   19   21.9    17.0  meadow.pipit  39
20   20   23.0    16.9  meadow.pipit  40
21   21   22.0    17.0  meadow.pipit  41
22   22   22.0    17.0  meadow.pipit  42
23   23   22.1    17.3  meadow.pipit  43
24   24   22.0    16.8  meadow.pipit  44
25   25   19.6    15.8  meadow.pipit  45
26   26   22.8    17.1  meadow.pipit  46
27   27   22.0    16.9  meadow.pipit  47
28   28   23.4    16.4  meadow.pipit  48
29   29   23.8    16.4  meadow.pipit  49
30   30   23.3    16.8  meadow.pipit  50
31   31   22.5    17.1  meadow.pipit  51
32   32   22.3    17.0  meadow.pipit  52
33   33   21.9    17.1  meadow.pipit  53
34   34   22.0    17.2  meadow.pipit  54
35   35   21.7    16.2  meadow.pipit  55
36   36   23.3    16.7  meadow.pipit  56
37   37   22.2    16.8  meadow.pipit  57
38   38   22.3    16.2  meadow.pipit  58
39   39   22.8    16.4  meadow.pipit  59
40   40   22.9    17.2  meadow.pipit  60
41   41   23.7    17.0  meadow.pipit  61
42   42   22.0    17.2  meadow.pipit  62
43   43   21.9    17.0  meadow.pipit  63
44   44   22.2    16.2  meadow.pipit  64
45   45   24.4    16.2  meadow.pipit  65
46   46   22.7    16.3    tree.pipit  66
47   47   23.3    16.6    tree.pipit  67
48   48   24.0    17.0    tree.pipit  68
49   49   23.6    16.9    tree.pipit  69
50   50   22.1    16.3    tree.pipit  70
51   51   21.8    16.7    tree.pipit  71
52   52   21.1    16.5    tree.pipit  72
53   53   23.4    16.2    tree.pipit  73
54   54   23.8    16.3    tree.pipit  74
55   55   23.3    16.7    tree.pipit  75
56   56   24.0    17.5    tree.pipit  76
57   57   23.5    17.3    tree.pipit  77
58   58   23.2    16.4    tree.pipit  78
59   59   24.0    17.3    tree.pipit  79
60   60   22.4    16.0    tree.pipit  80
61   61   22.0    17.0 hedge.sparrow  82
62   62   23.9    16.9 hedge.sparrow  83
63   63   20.9    15.8 hedge.sparrow  84
64   64   23.8    17.3 hedge.sparrow  85
65   65   25.0    17.5 hedge.sparrow  86
66   66   24.0    17.5 hedge.sparrow  87
67   67   21.7    16.2 hedge.sparrow  88
68   68   23.8    16.5 hedge.sparrow  89
69   69   22.8    16.2 hedge.sparrow  90
70   70   23.1    17.1 hedge.sparrow  91
71   71   23.1    16.1 hedge.sparrow  92
72   72   23.5    16.9 hedge.sparrow  93
73   73   23.0    16.7 hedge.sparrow  94
74   74   23.0    17.0 hedge.sparrow  95
75   75   21.8    16.0         robin  96
76   76   23.0    15.9         robin  97
77   77   23.3    17.1         robin  98
78   78   22.4    16.6         robin  99
79   79   22.4    16.9         robin 100
80   80   23.0    16.1         robin 101
81   81   23.0    17.2         robin 102
82   82   23.0    16.2         robin 103
83   83   23.9    16.9         robin 104
84   84   22.3    15.2         robin 105
85   85   22.0    16.3         robin 106
86   86   22.6    17.0         robin 107
87   87   22.0    16.0         robin 108
88   88   22.1    16.4         robin 109
89   89   21.1    16.4         robin 110
90   90   23.0    17.0         robin 111
91   91   23.0    16.3  pied.wagtail 198
92   92   23.4    16.7  pied.wagtail 199
93   93   24.0    17.0  pied.wagtail 200
94   94   23.3    16.3  pied.wagtail 201
95   95   23.1    16.7  pied.wagtail 202
96   96   22.4    16.5  pied.wagtail 203
97   97   21.8    16.0  pied.wagtail 204
98   98   21.8    16.0  pied.wagtail 205
99   99   24.9    16.8  pied.wagtail 206
100 100   24.0    15.8  pied.wagtail 207
101 101   22.1    16.2  pied.wagtail 208
102 102   21.0    17.1  pied.wagtail 209
103 103   22.6    16.0  pied.wagtail 210
104 104   21.9    16.9  pied.wagtail 211
105 105   24.0    17.2  pied.wagtail 212
106 106   19.8    15.0          wren 224
107 107   22.1    16.0          wren 225
108 108   21.5    16.2          wren 226
109 109   20.9    15.7          wren 227
110 110   22.0    16.2          wren 228
111 111   21.0    15.5          wren 229
112 112   22.3    16.0          wren 230
113 113   21.0    15.9          wren 231
114 114   20.3    15.5          wren 232
115 115   20.9    15.9          wren 233
116 116   22.0    16.0          wren 234
117 117   20.0    15.7          wren 235
118 118   20.8    15.9          wren 236
119 119   21.2    16.0          wren 237
120 120   21.0    16.0          wren 238
```
]

---
count: false
 
## Side-by-side Boxplot (1a)
.panel1-boxplot-auto[

```r
Cuckoo %&gt;%
* ggplot(aes(x=species,y=length,fill=species))
```
]
 
.panel2-boxplot-auto[
&lt;img src="Day25_files/figure-html/boxplot_auto_02_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Side-by-side Boxplot (1a)
.panel1-boxplot-auto[

```r
Cuckoo %&gt;%
  ggplot(aes(x=species,y=length,fill=species)) +
* theme_bw()
```
]
 
.panel2-boxplot-auto[
&lt;img src="Day25_files/figure-html/boxplot_auto_03_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Side-by-side Boxplot (1a)
.panel1-boxplot-auto[

```r
Cuckoo %&gt;%
  ggplot(aes(x=species,y=length,fill=species)) +
  theme_bw() +
* geom_boxplot()
```
]
 
.panel2-boxplot-auto[
&lt;img src="Day25_files/figure-html/boxplot_auto_04_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Side-by-side Boxplot (1a)
.panel1-boxplot-auto[

```r
Cuckoo %&gt;%
  ggplot(aes(x=species,y=length,fill=species)) +
  theme_bw() +
  geom_boxplot() +
* geom_jitter(width = 0.2)
```
]
 
.panel2-boxplot-auto[
&lt;img src="Day25_files/figure-html/boxplot_auto_05_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Side-by-side Boxplot (1a)
.panel1-boxplot-auto[

```r
Cuckoo %&gt;%
  ggplot(aes(x=species,y=length,fill=species)) +
  theme_bw() +
  geom_boxplot() +
  geom_jitter(width = 0.2) +
* labs(title ="Boxplot of the length of eggs per type",
*      y = "length (mm)",
*      x = "type")
```
]
 
.panel2-boxplot-auto[
&lt;img src="Day25_files/figure-html/boxplot_auto_06_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Side-by-side Boxplot (1a)
.panel1-boxplot-auto[

```r
Cuckoo %&gt;%
  ggplot(aes(x=species,y=length,fill=species)) +
  theme_bw() +
  geom_boxplot() +
  geom_jitter(width = 0.2) +
  labs(title ="Boxplot of the length of eggs per type",
       y = "length (mm)",
       x = "type") +
* stat_summary(fun=mean, geom="point", shape=10,
*              size=2, color="red", fill="black")
```
]
 
.panel2-boxplot-auto[
&lt;img src="Day25_files/figure-html/boxplot_auto_07_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Side-by-side Boxplot (1a)
.panel1-boxplot-auto[

```r
Cuckoo %&gt;%
  ggplot(aes(x=species,y=length,fill=species)) +
  theme_bw() +
  geom_boxplot() +
  geom_jitter(width = 0.2) +
  labs(title ="Boxplot of the length of eggs per type",
       y = "length (mm)",
       x = "type") +
  stat_summary(fun=mean, geom="point", shape=10,
               size=2, color="red", fill="black") +
* ggthemes::theme_tufte()
```
]
 
.panel2-boxplot-auto[
&lt;img src="Day25_files/figure-html/boxplot_auto_08_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Side-by-side Boxplot (1a)
.panel1-boxplot-auto[

```r
Cuckoo %&gt;%
  ggplot(aes(x=species,y=length,fill=species)) +
  theme_bw() +
  geom_boxplot() +
  geom_jitter(width = 0.2) +
  labs(title ="Boxplot of the length of eggs per type",
       y = "length (mm)",
       x = "type") +
  stat_summary(fun=mean, geom="point", shape=10,
               size=2, color="red", fill="black") +
  ggthemes::theme_tufte() +
* theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 0.5))
```
]
 
.panel2-boxplot-auto[
&lt;img src="Day25_files/figure-html/boxplot_auto_09_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Side-by-side Boxplot (1a)
.panel1-boxplot-auto[

```r
Cuckoo %&gt;%
  ggplot(aes(x=species,y=length,fill=species)) +
  theme_bw() +
  geom_boxplot() +
  geom_jitter(width = 0.2) +
  labs(title ="Boxplot of the length of eggs per type",
       y = "length (mm)",
       x = "type") +
  stat_summary(fun=mean, geom="point", shape=10,
               size=2, color="red", fill="black") +
  ggthemes::theme_tufte() +
  theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 0.5))
```
]
 
.panel2-boxplot-auto[
&lt;img src="Day25_files/figure-html/boxplot_auto_10_output-1.svg" width="100%" /&gt;
]

&lt;style&gt;
.panel1-boxplot-auto {
  color: black;
  width: 39.2%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 70%
}
.panel2-boxplot-auto {
  color: black;
  width: 58.8%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 70%
}
.panel3-boxplot-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 70%
}
&lt;/style&gt;



.scroll-output[

]

---

class: middle

# Check Assumptions (1b)

.bql[
`$$H_0: \text{The mean egg length is equal between the different bird tpyes.}$$`
`$$H_a: \text{The mean egg length for at least one bird type is different }$$`

Make sure that all assumptions for ANOVA are met:

- The data (length) must be normally distributed (in all groups)
- The variability within all groups is similar
]

---

count: false
 
## Approximate normality in groups (1b)
.panel1-normality-auto[

```r
*Cuckoo
```
]
 
.panel2-normality-auto[

```
      X length breadth       species  id
1     1   21.7    16.1  meadow.pipit  21
2     2   22.6    17.0  meadow.pipit  22
3     3   20.9    16.2  meadow.pipit  23
4     4   21.6    16.2  meadow.pipit  24
5     5   22.2    16.9  meadow.pipit  25
6     6   22.5    16.9  meadow.pipit  26
7     7   22.2    17.3  meadow.pipit  27
8     8   24.3    16.8  meadow.pipit  28
9     9   22.3    16.8  meadow.pipit  29
10   10   22.6    17.0  meadow.pipit  30
11   11   20.1    16.5  meadow.pipit  31
12   12   22.0    16.9  meadow.pipit  32
13   13   22.8    16.5  meadow.pipit  33
14   14   22.0    17.0  meadow.pipit  34
15   15   22.4    17.0  meadow.pipit  35
16   16   22.3    16.3  meadow.pipit  36
17   17   20.6    16.2  meadow.pipit  37
18   18   22.1    16.8  meadow.pipit  38
19   19   21.9    17.0  meadow.pipit  39
20   20   23.0    16.9  meadow.pipit  40
21   21   22.0    17.0  meadow.pipit  41
22   22   22.0    17.0  meadow.pipit  42
23   23   22.1    17.3  meadow.pipit  43
24   24   22.0    16.8  meadow.pipit  44
25   25   19.6    15.8  meadow.pipit  45
26   26   22.8    17.1  meadow.pipit  46
27   27   22.0    16.9  meadow.pipit  47
28   28   23.4    16.4  meadow.pipit  48
29   29   23.8    16.4  meadow.pipit  49
30   30   23.3    16.8  meadow.pipit  50
31   31   22.5    17.1  meadow.pipit  51
32   32   22.3    17.0  meadow.pipit  52
33   33   21.9    17.1  meadow.pipit  53
34   34   22.0    17.2  meadow.pipit  54
35   35   21.7    16.2  meadow.pipit  55
36   36   23.3    16.7  meadow.pipit  56
37   37   22.2    16.8  meadow.pipit  57
38   38   22.3    16.2  meadow.pipit  58
39   39   22.8    16.4  meadow.pipit  59
40   40   22.9    17.2  meadow.pipit  60
41   41   23.7    17.0  meadow.pipit  61
42   42   22.0    17.2  meadow.pipit  62
43   43   21.9    17.0  meadow.pipit  63
44   44   22.2    16.2  meadow.pipit  64
45   45   24.4    16.2  meadow.pipit  65
46   46   22.7    16.3    tree.pipit  66
47   47   23.3    16.6    tree.pipit  67
48   48   24.0    17.0    tree.pipit  68
49   49   23.6    16.9    tree.pipit  69
50   50   22.1    16.3    tree.pipit  70
51   51   21.8    16.7    tree.pipit  71
52   52   21.1    16.5    tree.pipit  72
53   53   23.4    16.2    tree.pipit  73
54   54   23.8    16.3    tree.pipit  74
55   55   23.3    16.7    tree.pipit  75
56   56   24.0    17.5    tree.pipit  76
57   57   23.5    17.3    tree.pipit  77
58   58   23.2    16.4    tree.pipit  78
59   59   24.0    17.3    tree.pipit  79
60   60   22.4    16.0    tree.pipit  80
61   61   22.0    17.0 hedge.sparrow  82
62   62   23.9    16.9 hedge.sparrow  83
63   63   20.9    15.8 hedge.sparrow  84
64   64   23.8    17.3 hedge.sparrow  85
65   65   25.0    17.5 hedge.sparrow  86
66   66   24.0    17.5 hedge.sparrow  87
67   67   21.7    16.2 hedge.sparrow  88
68   68   23.8    16.5 hedge.sparrow  89
69   69   22.8    16.2 hedge.sparrow  90
70   70   23.1    17.1 hedge.sparrow  91
71   71   23.1    16.1 hedge.sparrow  92
72   72   23.5    16.9 hedge.sparrow  93
73   73   23.0    16.7 hedge.sparrow  94
74   74   23.0    17.0 hedge.sparrow  95
75   75   21.8    16.0         robin  96
76   76   23.0    15.9         robin  97
77   77   23.3    17.1         robin  98
78   78   22.4    16.6         robin  99
79   79   22.4    16.9         robin 100
80   80   23.0    16.1         robin 101
81   81   23.0    17.2         robin 102
82   82   23.0    16.2         robin 103
83   83   23.9    16.9         robin 104
84   84   22.3    15.2         robin 105
85   85   22.0    16.3         robin 106
86   86   22.6    17.0         robin 107
87   87   22.0    16.0         robin 108
88   88   22.1    16.4         robin 109
89   89   21.1    16.4         robin 110
90   90   23.0    17.0         robin 111
91   91   23.0    16.3  pied.wagtail 198
92   92   23.4    16.7  pied.wagtail 199
93   93   24.0    17.0  pied.wagtail 200
94   94   23.3    16.3  pied.wagtail 201
95   95   23.1    16.7  pied.wagtail 202
96   96   22.4    16.5  pied.wagtail 203
97   97   21.8    16.0  pied.wagtail 204
98   98   21.8    16.0  pied.wagtail 205
99   99   24.9    16.8  pied.wagtail 206
100 100   24.0    15.8  pied.wagtail 207
101 101   22.1    16.2  pied.wagtail 208
102 102   21.0    17.1  pied.wagtail 209
103 103   22.6    16.0  pied.wagtail 210
104 104   21.9    16.9  pied.wagtail 211
105 105   24.0    17.2  pied.wagtail 212
106 106   19.8    15.0          wren 224
107 107   22.1    16.0          wren 225
108 108   21.5    16.2          wren 226
109 109   20.9    15.7          wren 227
110 110   22.0    16.2          wren 228
111 111   21.0    15.5          wren 229
112 112   22.3    16.0          wren 230
113 113   21.0    15.9          wren 231
114 114   20.3    15.5          wren 232
115 115   20.9    15.9          wren 233
116 116   22.0    16.0          wren 234
117 117   20.0    15.7          wren 235
118 118   20.8    15.9          wren 236
119 119   21.2    16.0          wren 237
120 120   21.0    16.0          wren 238
```
]

---
count: false
 
## Approximate normality in groups (1b)
.panel1-normality-auto[

```r
Cuckoo %&gt;%
* ggplot(aes(sample=length))
```
]
 
.panel2-normality-auto[
&lt;img src="Day25_files/figure-html/normality_auto_02_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Approximate normality in groups (1b)
.panel1-normality-auto[

```r
Cuckoo %&gt;%
  ggplot(aes(sample=length)) +
* geom_qq()
```
]
 
.panel2-normality-auto[
&lt;img src="Day25_files/figure-html/normality_auto_03_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Approximate normality in groups (1b)
.panel1-normality-auto[

```r
Cuckoo %&gt;%
  ggplot(aes(sample=length)) +
  geom_qq() +
* geom_qq_line()
```
]
 
.panel2-normality-auto[
&lt;img src="Day25_files/figure-html/normality_auto_04_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Approximate normality in groups (1b)
.panel1-normality-auto[

```r
Cuckoo %&gt;%
  ggplot(aes(sample=length)) +
  geom_qq() +
  geom_qq_line() +
* facet_grid(~species)
```
]
 
.panel2-normality-auto[
&lt;img src="Day25_files/figure-html/normality_auto_05_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Approximate normality in groups (1b)
.panel1-normality-auto[

```r
Cuckoo %&gt;%
  ggplot(aes(sample=length)) +
  geom_qq() +
  geom_qq_line() +
  facet_grid(~species) +
* theme(strip.text.x = element_text(size = 6))
```
]
 
.panel2-normality-auto[
&lt;img src="Day25_files/figure-html/normality_auto_06_output-1.svg" width="100%" /&gt;
]

---
count: false
 
## Approximate normality in groups (1b)
.panel1-normality-auto[

```r
Cuckoo %&gt;%
  ggplot(aes(sample=length)) +
  geom_qq() +
  geom_qq_line() +
  facet_grid(~species) +
  theme(strip.text.x = element_text(size = 6)) +
* theme_bw()
```
]
 
.panel2-normality-auto[
&lt;img src="Day25_files/figure-html/normality_auto_07_output-1.svg" width="100%" /&gt;
]

&lt;style&gt;
.panel1-normality-auto {
  color: black;
  width: 29.4%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 70%
}
.panel2-normality-auto {
  color: black;
  width: 68.6%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 70%
}
.panel3-normality-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 70%
}
&lt;/style&gt;



.scroll-output[


]

---

# Fitting ANOVA (1c)


```r
library(broom)
fit_anova &lt;- aov(length~species, Cuckoo)
knitr::kable(tidy(fit_anova))
```



|term      |  df|    sumsq|    meansq| statistic| p.value|
|:---------|---:|--------:|---------:|---------:|-------:|
|species   |   5| 42.81015| 8.5620298|  10.44934|       0|
|Residuals | 114| 93.40985| 0.8193847|        NA|      NA|

&lt;br&gt;

--

.bql[
Since the .b[p-value] is very small, at the significance level of `\(5\%\)`, we have sufficient evidence to conclude that the mean egg length for at least one bird type is .b[different] from the mean egg length in at least one other bird type.
]

--

.out-t.font100[But which of the species are different?]

---

class: middle

# Inference after ANOVA

.bql[Compute a CI for any `\(\mu_i\)`

`$$\bar{x}_i \pm t^{*} \frac{s_i}{\sqrt{n_i}}$$`
]

.b.font90[
.b[BUT] after .b[ANOVA], estimate any `\(\sigma\)` with the pooled standard deviation:

`$$\bar{x}_i \pm t^{*}\frac{\sqrt{MSE}}{\sqrt{n_i}}$$`

the corresponding `df=n-k`
]

---

# Cuckoo Eggs (1d)
.bqt.font90[Find a 95% confidence interval for the mean cuckoo egg length in .b[European robin] nests (Type = 4).]

.pull-left-60[
.font80[

```r
MSE &lt;- 0.8193847
knitr::kable(tidy(fit_anova))
```



|term      |  df|    sumsq|    meansq| statistic| p.value|
|:---------|---:|--------:|---------:|---------:|-------:|
|species   |   5| 42.81015| 8.5620298|  10.44934|       0|
|Residuals | 114| 93.40985| 0.8193847|        NA|      NA|
]
]
.pull-right-40[
.font80[

|species       |     mean|        sd|  n|
|:-------------|--------:|---------:|--:|
|hedge.sparrow | 23.11429| 1.0494373| 14|
|meadow.pipit  | 22.29333| 0.9195849| 45|
|pied.wagtail  | 22.88667| 1.0722917| 15|
|robin         | 22.55625| 0.6821229| 16|
|tree.pipit    | 23.08000| 0.8800974| 15|
|wren          | 21.12000| 0.7542262| 15|
]
]

`$$\bar{x}_i \pm t^{*}\frac{\sqrt{MSE}}{\sqrt{n_i}}, \text{ df = n-k }$$`

---

# Inference after ANOVA

`$$H_0: \mu_i = \mu_j \text{ vs. } H_a: \mu_i \neq \mu_j$$`


.bql.font90[Compute a CI for `\(\mu_i - \mu_j\)`

`$$(\bar{x}_i - \bar{x}_j) \pm t^{*} \sqrt{\frac{s_i^2}{n_i} + \frac{s_j^2}{n_j}}$$`

]

.b.font90[
Use the usual procedures except estimate any `\(\sigma\)` with the pooled standard deviation: `\(\sqrt{MSE}\)` and use the error degrees of freedom, `df=n-k`, for any t-values
  `$$(\bar{x}_i - \bar{x}_j) \pm t^{*} \sqrt{MSE \left(\frac{1}{n_i} + \frac{1}{n_j}\right)}$$`
]


---

# Cuckoo Eggs (1e)

Find a 95% CI for the difference in mean egg length between .b[European robin](type = 4) and .b[Eurasian wren](type = 6) nests.

.pull-left-60[

.font80[

|term      |  df|    sumsq|    meansq| statistic| p.value|
|:---------|---:|--------:|---------:|---------:|-------:|
|species   |   5| 42.81015| 8.5620298|  10.44934|       0|
|Residuals | 114| 93.40985| 0.8193847|        NA|      NA|
]
`$$(22.556 - 21.120) \pm 1.981 \cdot \sqrt{0.8194\left(\frac{1}{16} + \frac{1}{15} \right)} = (0.792, 2.081)$$`
]
.pull-right-40[
.font80[

|species       |     mean|        sd|  n|
|:-------------|--------:|---------:|--:|
|hedge.sparrow | 23.11429| 1.0494373| 14|
|meadow.pipit  | 22.29333| 0.9195849| 45|
|pied.wagtail  | 22.88667| 1.0722917| 15|
|robin         | 22.55625| 0.6821229| 16|
|tree.pipit    | 23.08000| 0.8800974| 15|
|wren          | 21.12000| 0.7542262| 15|
]
]


.code70[

```r
(stat[4,2] - stat[6,2]) + c(-1,1)* (qt(1-0.05/2, df=114))* sqrt(MSE*(1/stat[4,4] + 1/stat[6,4]))
[1] 0.7917811 2.0807189
```
]

--

.out-t.font80[Why is it important that the interval contains only positive values?]


---

# Cuckoo Eggs (1f)

.bql.font80[Find a 95% CI for the difference in mean egg length between .b[Pied Wagtail] (type = 3) and .b[European robin](type = 4)  nests.]

.pull-left-60[
.font80[

|term      |  df|    sumsq|    meansq| statistic| p.value|
|:---------|---:|--------:|---------:|---------:|-------:|
|species   |   5| 42.81015| 8.5620298|  10.44934|       0|
|Residuals | 114| 93.40985| 0.8193847|        NA|      NA|
]
`$$(22.887 - 22.556) \pm 1.981\cdot \sqrt{0.8194\left(\frac{1}{15} + \frac{1}{16} \right)} = (-0.314, 0.975)$$`

]
.pull-right-40[
.font80[

|species       |     mean|        sd|  n|
|:-------------|--------:|---------:|--:|
|hedge.sparrow | 23.11429| 1.0494373| 14|
|meadow.pipit  | 22.29333| 0.9195849| 45|
|pied.wagtail  | 22.88667| 1.0722917| 15|
|robin         | 22.55625| 0.6821229| 16|
|tree.pipit    | 23.08000| 0.8800974| 15|
|wren          | 21.12000| 0.7542262| 15|
]
]

.code70[

```r
(stat[3,2] - stat[4,2]) + c(-1,1)* (qt(1-0.05/2, df=114))*sqrt(MSE*(1/stat[3,4] + 1/stat[4,4]))
[1] -0.3140522  0.9748855
```
]


--

.out-t.font80[What does it mean if the interval contains 0?]

---

class: middle

# Mutiple Comparisons 

.bql.font90[Often, doing pairwise comparisons after ANOVA involves many tests

  - e.g. `\(k\)` groups/categories,then we have `\(\frac{k(k-1)}{2}\)` comparisons
  - `\(k=6\)` bird species then 15 pairwise tests.
]

---

class: middle

# Mutiple Comparisons 


.bql.font90[If each test has an `\(\alpha\)` chance of a Type I error (finding a difference between a pair that aren’t different),  the overall Type I error rate can be much higher.
]

.bqt[
Use a smaller `\(\alpha\)` for each pairwise test (Bonferroni)
  - `\(\alpha^{*} = \frac{\alpha}{k}\)`
  - e.g `\(\alpha = 0.05\)` and `\(k = 6\)`, then `\(\alpha^{*} = 0.05/6 =  0.0083\)`
]
---


# Cuckoo Eggs (1g)

&gt; Which means are “different” at a `\(5\%\)` significance level?


```r
pairwise.t.test(Cuckoo$length, Cuckoo$species, p.adjust.method =  "bonferroni")
```

```

	Pairwise comparisons using t tests with pooled SD 

data:  Cuckoo$length and Cuckoo$species 

             hedge.sparrow meadow.pipit pied.wagtail robin   tree.pipit
meadow.pipit 0.05554       -            -            -       -         
pied.wagtail 1.00000       0.44898      -            -       -         
robin        1.00000       1.00000      1.00000      -       -         
tree.pipit   1.00000       0.06426      1.00000      1.00000 -         
wren         5e-07         0.00045      7e-06        0.00035 5e-07     

P value adjustment method: bonferroni 
```

---

class: action

# &lt;i class="fa fa-pencil-square-o" style="font-size:48px;color:purple"&gt;&amp;nbsp;Your&amp;nbsp;Turn&amp;nbsp;1&lt;/i&gt;    

.pull-left-40[
![](https://media.giphy.com/media/RKApDdwsQ6jkwd6RNn/giphy.gif)
]
.pull-right-60[

&lt;br&gt;
&lt;br&gt;

.bql[
- Go over to the in-class activity file
- Complete the remaining activity 
]
]

<div class="countdown" id="timer_6f8dda73" data-update-every="1" tabindex="0" style="top:0;right:0;padding:3px 4px;font-size:2em;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">10</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="libs/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "googlecode",
"highlightLines": true,
"highlightLanguage": ["r", "css", "yaml"],
"countIncrementalSlides": true,
"slideNumberFormat": "%current%",
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
