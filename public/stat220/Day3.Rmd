---
title: "Data Objects and Visualization"
subtitle: "<br/> Fall 2022"
author: "Bastola"
date: "`r format(Sys.Date(), ' %B %d %Y')`"
output:
  xaringan::moon_reader:
    css: ["default", css/xaringan-themer-solns.css, css/my-theme.css, css/my-font.css]
    lib_dir: libs
    chakra: libs/remark-latest.min.js
    seal: false
    nature:
      highlightStyle: googlecode  #http://arm.rbind.io/slides/xaringan.html#77 # idea, magula
      highlightLines: true
      highlightLanguage: ["r", "css", "yaml"]
      countIncrementalSlides: true
      slideNumberFormat: "%current%"
      titleSlideClass: ["left", "middle", "inverse"]
      ratio: "16:9"
    includes:
      in_header: header.html
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
options(htmltools.preserve.raw = FALSE)
options(ggrepel.max.overlaps = Inf)

knitr::opts_chunk$set(echo = TRUE, 
                      dev = 'svg',
                      collapse = TRUE, 
                      comment = NA,  # PRINTS IN FRONT OF OUTPUT, default is '##' which comments out output
                      prompt = FALSE, # IF TRUE adds a > before each code input
                      warning = FALSE, 
                      message = FALSE,
                      fig.height = 3, 
                      fig.width = 4,
                      out.width = "100%",
                      prompt = FALSE
                      )

# load necessary packages
library(Sleuth3)   # Data-set for Sleuth
library(tidyverse)
library(dplyr)
library(countdown)
library(mosaic)
library(ggthemes)
library(xaringanExtra)
library(forcats)
xaringanExtra::use_panelset()
xaringanExtra::use_tachyons()
xaringanExtra::use_clipboard()
xaringanExtra::use_extra_styles(
  hover_code_line = TRUE,         
  mute_unhighlighted_code = TRUE  
)
library(flipbookr)
library(patchwork)
library(DT)
library(moderndive)
library(knitr)
library(grid)
library(gridExtra)
library(palmerpenguins)
library(broom)
library(ggResidpanel)
library(keras)
library(tensorflow)

select <- dplyr::select

# Set ggplot theme
theme_set(theme_tufte(base_size = 10))

yt <- 0

# read.csv("https://raw.githubusercontent.com/deepbas/statdatasets/main/agstrat.csv")

```


```{r xaringanExtra-clipboard, echo=FALSE}
htmltools::tagList(
  xaringanExtra::use_clipboard(
    button_text = "<i class=\"fa fa-clipboard\"></i>",
    success_text = "<i class=\"fa fa-check\" style=\"color: #90BE6D\"></i>",
    error_text = "<i class=\"fa fa-times-circle\" style=\"color: #F94144\"></i>"
  ),
  rmarkdown::html_dependency_font_awesome()
)
```


layout: true
  
---

class: title-slide, middle

# .fancy[Data Objects and Visualization]

### .fancy[Fall 2022]

`r format(Sys.Date(), ' %B %d %Y')`

---



# Object Oriented Programming

.bql.font80[
In R, commands care about object class and type

  - Ex: the default `plot` command wants a vector of data or a formula to form a scatterplot
]

```{r, eval=FALSE}
plot(y ~ x, data= mydata) # makes scatterplot if x and y numeric
```

--

> But if you give `plot` a `lm` regression object it will produce a set of diagnostic plots for that regression model.

```{r, eval=FALSE}
my_lm <- lm(y ~ x, data= mydata)  # make a linear model
plot(my_lm)  # makes multiple diagnostic plots
```

---

class: middle

# Data structures and types in R

.pull-left.font90[

.bq[

- Every object is a **vector** 

- `NULL` = empty object (vector of length 0)

  - `typeof()`: tells us about storage of data
  - `class()` further describes the object
]

]    


.pull-right[

```{r}
x <- c(8,2,1,3)
typeof(x)  # type of storage mode 
typeof(c(8L,2L,1L,3L))  # adding L forces integer type
```

```{r}
x == 1
typeof(x == 1)
class(x)   # object class is numeric
```

]

---



class: middle

# Atomic Vectors and lists


.pull-left[
<br>
.bq[
- R uses two types of vectors to store info

    - **atomic vectors**: all entries have the same data type 
    - **lists**: entries can contain other objects that can differ in data type
]    
]

.pull-right[

<img src="images/atomic_vectors.png" width="110%" height="110%"> <br>

]


---

# Atomic Vectors: Matrices

.bq[
- You can add **attributes**, such as **dimension**, to vectors
- A **matrix** is a 2-dimensional vector containing entries of the same type
]

--

.pull-left-60[

```{r}
x_mat <- matrix(x, nrow = 2, byrow = TRUE)
x_mat
attributes(x_mat)
```


```{r}
typeof(x_mat)   # type of entries
class(x_mat)   # info about object
```

]

--
.pull-right-40[

- or you can bind vectors of the same length to create columns or rows:

```{r}
x_mat2 <- cbind(x, 2*x)
x_mat2
```


]

---

# Implicit Coercion 

.bq[
- Entries in atomic vectors must be the same data type
- R will default to the most complex data type if more than one type is given
]

```{r}
y <- c(1, 2, "a")
```


```{r}
typeof(y)
y
```

---

# Explicit coercion


> - Intentionally forces a data type that is different from the "default" type

```{r}
y <- as.character(c(1,2,3))
```

```{r, tidy = TRUE}
typeof(y)
y
```

---

# Logical Vectors coercion

> - Logical values coerced into 0 for `FALSE` and 1 for `TRUE` when applying math functions

```{r}
x <- c(8,2,1,3)
x >= 5  # which entries >= 5?
sum(x >= 5)  # how many >=5 ?
```

- What will `mean` of a logical vector measure?

```{r, eval = FALSE}
mean(x >= 5) 
```

--


```{r, echo=FALSE}
mean(x >= 5) 
```

---

# Data types: factors 

- Factors are a class of data that are stored as **integers**

.code80[
```{r}
x_fct <- as.factor(c("yes", "no", "no"))
class(x_fct)
typeof(x_fct)
```
]

--

.bq.font80[
- The attribute `levels` is a character vector of possible values

  - Values are stored as the integers (1=first `level`, 2=second `level`, etc)
  - Levels are ordered alphabetically/numerically (unless specified otherwise)
]
    
--

```{r}
str(x_fct)
levels(x_fct)
```
---

# Subsetting: Atomic Vector and Matrices

.pull-left.font80[
- subset with `[]` by referencing index value (from 1 to vector length):

```{r}
x
x[c(4, 2)]  # get 4th and 2nd entries
```

- subset by omitting entries

```{r}
x[-c(4, 2)]  # omit 4th and 2nd entries
```

- subset with a logical vector

```{r}
# get 1st and 3rd entries
x[c(TRUE, FALSE, TRUE, FALSE)]
```

]

--

.pull-right.font80[

- access entries using subsetting `[row,column]`
```{r}
x_mat2
```



```{r}
x_mat2[, 1] # first column
```



```{r}
x_mat2[1:2, 1] # first 2 rows of first column
```

.yellow-h[R doesn't always preserve class]:  

```{r, inline = FALSE}
# one row (or col) is no longer a matrix (1D)
class(x_mat2[1,])  
```

]

---

# Subsetting: Atomic Vector and Matrices

.pull-left[
- you can access entries like a matrix:

```{r}
x_df <- data.frame(x = x, double_x = x*2)
x_df
```


```{r}
x_df[, 1]  # first column, all rows
```

]

--

.pull-right[

- or access columns with `$`

```{r}
x_df$x  # get variable x column
```


```{r}
# first column is no longer a dataframe
class(x_df[, 1])  
```

]

---

class: middle

# Subsetting: Data frames or Tibbles

.pull-left[
.bq.font80[
### Tibbles
- are a new modern data frame

- never changes the input data types

- can have columns that are lists

- can have non-standard variable names

  - can start with a number or contain spaces
]
]

--

.pull-right[

- Can also use column names to subset:

```{r}
library(babynames)
# get 2 rows of Name and Sex
babynames[1:2, c("name", "sex")] 
```
]


---

# Subsetting lists

.pull-left[

- Recall: a **list** is a vector with entries that can be different object types

```{r}
my_list <- list(myVec = x, 
                myDf = x_df, 
                myString = c("hi", "bye"))
my_list
```

]

--

.pull-right[

- Like a data frame, can use the `$` to access **named** objects stored in the list

```{r}
my_list$myDf
```


```{r}
class(my_list$myDf)
```

]

---

# Subsetting lists

.pull-left.font80[
.bq.font80[
- one `[]` operator gives you the object at the given location but preserves the list type

  - `my_list[2]` return a **list** of length one with entry `myDf` 
]
  
```{r}
my_list[2]
```


```{r}
str(my_list[2])
```


]

.pull-right.font80[

.bq.font80[
- the double  `[[]]` operator  gives you the object stored at that location (equivalent to using `$`)

  - `my_list[[2]]` or `my_list[["myDf"]]` return the **data frame** `myDf` 
]

```{r}
my_list[[2]]
str(my_list[[2]])
```


]

---

class: action, middle

# <i class="fa fa-pencil-square-o" style="font-size:48px;color:purple">&nbsp;Group&nbsp;Activity&nbsp;`r (yt <- yt + 1)`</i>    


.pull-left-40[
![](https://media.giphy.com/media/RKApDdwsQ6jkwd6RNn/giphy.gif)
]
.pull-right-60[
<br>
<br>
.bq[
- Let's go over to maize server/ local Rstudio and our class [moodle](https://moodle.carleton.edu/course/view.php?id=39491)
- Get the class activity 3 file
- Please work on Problems 1-3
- Ask me questions
- Any Github related questions??
]
]

`r countdown(minutes = 10, seconds = 00, top = 0 , color_background = "inherit", padding = "3px 4px", font_size = "2em")`

---

class: center, inverse, bottom
background-image: url("images/data_viz.jpg")
background-size: cover

## .white.bold.font120[Data Visualization provides a powerful way to communicate data-driven findings, motivate analyses, and detect flaw]

---

# **ggplot2**  &mdash; Overview

.bql[
- A powerful package for visualising data 
- Used widely by academics and industries alike
]
<br>
.bq[
## Some useful resources
  - [The package documentation](https://www.rdocumentation.org/packages/ggplot2/versions/3.2.1)
  - [The book](https://ggplot2-book.org/) by its creator Hadley Wickham
  - [The reference page](https://ggplot2.tidyverse.org/reference/)
  - [The extensions](https://exts.ggplot2.tidyverse.org/), maintained by the `ggplot2` community
]

---

# **ggplot2** &mdash; Basics 

.bq.font80[
- The `ggplot` function and the `data` argument

  + specify a data frame in the main `ggplot` function
]

```{r, prompt=FALSE, eval=FALSE, tidy=FALSE}
ggplot(data = df)
```

--

.bq.font80[
- The mapping aesthetics, or .out-t[aes]; most importantly, the variable(s) that we want to plot

  - specify as an additional argument in the same `ggplot` function
]

```{r, prompt=FALSE, eval=FALSE, tidy=FALSE}
ggplot(data = df, mapping = aes(x = x-variable, y = y-variable))
```

---

# **ggplot2** &mdash; Basics

.bq[
- The geometric objects, or .out-t[geom]; the visual representations

  - specify, after a plus sign .yellow-h[+], as an additional function
]

```{r, prompt=FALSE, eval=FALSE, tidy=FALSE}
ggplot(data = df, mapping = aes(x = x-variable, y = y-variable)) +
       geom_point() #<<
```

- Additional aesthestics like `color`, `size`, `shape`, and `alpha` (i.e. transparency) are possible.
  
```{r, prompt=FALSE, eval=FALSE, tidy=FALSE}
ggplot(data = df, mapping = aes(x = x-variable, y = y-variable)) +
       geom_point(color = z-variable) #<<
```


---

class: action, middle

# <i class="fa fa-pencil-square-o" style="font-size:48px;color:purple">&nbsp;Group&nbsp;Activity&nbsp;`r (yt <- yt + 1)`</i>    


.pull-left-40[
![](https://media.giphy.com/media/RKApDdwsQ6jkwd6RNn/giphy.gif)
]
.pull-right-60[
<br>
<br>
.bq[
- Continue working on Problems 4-5
- Ask me questions
- Any more Github setup questions?
]
]

`r countdown(minutes = 10, seconds = 00, top = 0 , color_background = "inherit", padding = "3px 4px", font_size = "2em")`
