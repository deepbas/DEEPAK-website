---
title: "Additional topics in testing"
subtitle: "<br/> STAT 120"
author: "Bastola"
date: "`r format(Sys.Date(), ' %B %d %Y')`"
output:
  xaringan::moon_reader:
    css: ["default", css/xaringan-themer-solns.css, css/my-font.css]
    lib_dir: libs
    chakra: libs/remark-latest.min.js
    seal: false
    nature:
      highlightStyle: magula  #http://arm.rbind.io/slides/xaringan.html#77 # idea, magula, googlecode, default
      highlightLines: true
      highlightLanguage: ["r", "css", "yaml"]
      countIncrementalSlides: true
      slideNumberFormat: "%current%"
      titleSlideClass: ["left", "middle", "inverse"]
      ratio: "16:9"
    includes:
      in_header: header.html  
editor_options: 
  chunk_output_type: console
---


```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
options(htmltools.preserve.raw = FALSE)
options(ggrepel.max.overlaps = Inf)

knitr::opts_chunk$set(echo = TRUE, 
                      dev = 'svg',
                      collapse = TRUE, 
                      comment = NA,  # PRINTS IN FRONT OF OUTPUT, default is '##' which comments out output
                      prompt = FALSE, # IF TRUE adds a > before each code input
                      warning = FALSE, 
                      message = FALSE,
                      fig.height = 3, 
                      fig.width = 4,
                      out.width = "100%"
                      )



# load necessary packages
library(tidyverse)
library(countdown)
library(mosaic)
library(ggthemes)
library(xaringanExtra)
library(forcats)
xaringanExtra::use_panelset()
xaringanExtra::use_tachyons()
xaringanExtra::use_clipboard()
xaringanExtra::use_extra_styles(
  hover_code_line = TRUE,         #<<
  mute_unhighlighted_code = TRUE  #<<
)
library(flipbookr)
library(patchwork)
library(Lock5Data)

# Set ggplot theme
theme_set(theme_tufte(base_size = 10))


yt <- 0

# read.csv("https://raw.githubusercontent.com/deepbas/statdatasets/main/APM_DougEvansCases.csv")

```



```{r xaringanExtra-clipboard, echo=FALSE}
# Icon for your turn
htmltools::tagList(
  xaringanExtra::use_clipboard(
    button_text = "<i class=\"fa fa-clipboard\"></i>",
    success_text = "<i class=\"fa fa-check\" style=\"color: #90BE6D\"></i>",
    error_text = "<i class=\"fa fa-times-circle\" style=\"color: #F94144\"></i>"
  ),
  rmarkdown::html_dependency_font_awesome()
)
```


layout: true
  
<!-- <div class="my-footer"><span>Stat 230</span></div> -->
<!-- this adds the link footer to all slides, depends on my-footer class in css-->

---

class: title-slide, middle
<!-- background-image: url("images/title-image2.png") -->
background-position: 10% 90%, 100% 50%
background-size: 160px, 100% 100%

# .fancy[Additional topics in testing]

### .fancy[Stat 120]

`r format(Sys.Date(), ' %B %d %Y')`


---

# Question 1

.bql.font80[
A new blood thinning drug is being tested against the current drug in a double-blind experiment. Is there evidence that the mean blood thinness rating is higher for the new drug? Using $n$ for the new drug and $o$ for the old drug, which of the following are the null and alternative hypotheses?
]

<br>


.hljs[
A. $\mathrm{H}_0: \mu_{\mathrm{n}}>\mu_0 \quad\mathrm{Vs}\quad \mathrm{H}_{\mathrm{a}}: \mu_{\mathrm{n}}=\mu_{\mathrm{o}}$

B. $H_0: \mu_n=\mu_0 \quad \mathrm{Vs} \quad H_2: \mu_n \neq \mu_0$

C. $\mathrm{H}_0: \mu_{\mathrm{n}}=\mu_0\quad\mathrm{Vs}\quad\mathrm{H}_{\mathrm{a}}: \mu_{\mathrm{n}}>\mu_0$

D. $\mathrm{H}_0: \bar{x}_n=\bar{x}_o \quad \mathrm{Vs} \quad \mathrm{H}_{\mathrm{a}}: \bar{x}_n \neq \bar{x}_o$

E. $\mathrm{H}_0: \bar{x}_n=\bar{x}_o\quad\mathrm{Vs}\quad\mathrm{H}_{\mathrm{a}}: \bar{x}_n>\bar{x}_o$
]


<details>
<summary class="answer">Click for answer</summary>
The correct answer is C.
</details>


---

# Question 2

.bql.font80[
A new blood thinning drug is being tested against the current drug in a double-blind experiment, and the hypotheses are:
$$\mathrm{H}_0: \mu_{\mathrm{n}}=\mu_{\mathrm{o}} \quad \text { vS } \quad \mathrm{H}_{\mathrm{a}}: \mu_{\mathrm{n}}>\mu_{\mathrm{o}}$$
What does a Type I Error mean in this situation?
]


.hljs[
A. We reject $\mathrm{H}_0$

B. We do not reject $\mathrm{H}_0$

C. We find evidence the new drug is better when it is really not better.

D. We are not able to conclude that the new drug is better even though it really is.

E. We are able to conclude that the new drug is better.
]



<details>
<summary class="answer">Click for answer</summary>
The correct answer is C.
</details>


---


# Question 3

.bql.font80[
A new blood thinning drug is being tested against the current drug in a double-blind experiment, and the hypotheses are:
$$\mathrm{H}_0: \mu_{\mathrm{n}}=\mu_{\mathrm{o}} \quad \text { vS } \quad \mathrm{H}_{\mathrm{a}}: \mu_{\mathrm{n}}>\mu_{\mathrm{o}}$$

What does a Type II Error mean in this situation?
]


.hljs[
A. We reject $\mathrm{H}_0$

B. We do not reject $\mathrm{H}_0$

C. We find evidence the new drug is better when it is really not better.

D. We are not able to conclude that the new drug is better even though it really is.

E. We are able to conclude that the new drug is better.
]



<details>
<summary class="answer">Click for answer</summary>
The correct answer is D.
</details>

---


# Question 4

.bql.font80[
A new blood thinning drug is being tested against the current drug in a double-blind experiment, and the hypotheses are:
$$\mathrm{H}_0: \mu_{\mathrm{n}}=\mu_{\mathrm{o}} \quad \text { vS } \quad \mathrm{H}_{\mathrm{a}}: \mu_{\mathrm{n}}>\mu_{\mathrm{o}}$$

If the new drug has potentially serious side effects, we should pick a significance level that is:]


.hljs[
A. Relatively small (such as $1 \%$ )

B. Middle of the road ($5\%$)

C. Relatively large (such as $10 \%$ )

]



<details>
<summary class="answer">Click for answer</summary>
The correct answer is A. Since a Type 1 error would be serious, we use a small significance level
</details>


---


# Question 5

.bql.font80[
A new blood thinning drug is being tested against the current drug in a double-blind experiment, and the hypotheses are:
$$\mathrm{H}_0: \mu_{\mathrm{n}}=\mu_{\mathrm{o}} \quad \text { vS } \quad \mathrm{H}_{\mathrm{a}}: \mu_{\mathrm{n}}>\mu_{\mathrm{o}}$$

If the new drug has no real side effects and costs less than the old drug, we might pick a significance level that is:]

.hljs[
A. Relatively small (such as $1 \%$ )

B. Middle of the road ($5\%$)

C. Relatively large (such as $10 \%$ )

]



<details>
<summary class="answer">Click for answer</summary>
The correct answer is C. Since a Type 1 error is not at all serious here, we might use a large significance level
</details>

---

# Probability of Type II Error


.bql.font80[
How can we reduce the probability of making a Type II Error (not rejecting a false null)?]


.hljs[

a) Decrease the sample size

b) Increase the sample size

]


<details>
<summary class="answer">Click for detailed answer</summary>
.blue-h.fancy[The correct answer is b, increase the sample size. As the sample size increases, the power of the test increases, reducing Type II error. As the sample size increases, the variability in the sample estimates decreases, leading to a decrease in the standard error. This reduced variability increases the power of the test and decreases the chances of a Type II error.With larger sample sizes, confidence intervals become narrower, indicating a higher precision in estimating the population parameter. Narrower confidence intervals make it easier to detect a significant difference between the null hypothesis and the alternative hypothesis, thus reducing the probability of a Type II error. ] 
</details>

---


# Randomization distribution with $n=10$

<center>
<img src="images/day13-8.png" width="60%" height="30%"> <br>
</center>


---

# Randomization distribution with $n=100$


<center>
<img src="images/day13-9.png" width="60%" height="30%"> <br>
</center>



---

<br>

.pull-left[## .bold[Bootstrap Distribution]

.bq.font90[
- Our best guess at the distribution of sample statistics

- Centered around the observed sample statistic

- Simulate sampling from the population by resampling from the original sample
]
]

.pull-right[## .bold[Randomization Distribution]

.bq.font90[
- Our best guess at the distribution of sample statistics, if $\mathrm{H}_0$ were true 

- Centered around the null hypothesized value

- Simulate samples assuming $\mathrm{H}_0$ were true
]
]

--

.out-t[
.b[Big difference]: a randomization distribution assumes $H_0$ is true, while a bootstrap distribution does not]

---

# Example: bootstrap or randomization?

<center>
<img src="images/day13-5.png" width="60%" height="30%"> <br>
</center>

---

# Example: bootstrap or randomization?

<center>
<img src="images/day13-4.png" width="55%" height="30%"> <br>
</center>


---

class: middle

# Using confidence intervals for hypothesis testing

.bq.font110[
If a $95 \%$ CI contains the parameter in $\mathrm{H}_0$, then a two-tailed test should not reject $\mathrm{H}_0$ at a $5 \%$ significance level.
]

<br>
--

.bq.font110[
If a $95 \%$ CI misses the parameter in $\mathrm{H}_0$, then a two-tailed test should reject $\mathrm{H}_0$ at a $5 \%$ significance level.
]

---

<center>
<img src="images/day13-6.png" width="60%" height="30%"> <br>
</center>

.bq[The 95% confidence interval misses null difference of 0. Reject the null at 5% level]


---

<center>
<img src="images/day13-7.png" width="60%" height="30%"> <br>
</center>


.bq[The 99% confidence interval contains null difference of 0. Do not reject the null at 1% level]

---

class: middle

# Multiple Testing/Comparison


.bql[
When multiple hypothesis tests are conducted, the chance that at least one test incorrectly rejects a true null hypothesis increases with the number of tests.

- If the null hypotheses are all true, $\alpha$ of the tests will yield statistically significant results just by random chance.
]

---

class: middle

# Diet and Sex of Baby


.bql[
- Are certain foods in your diet associated with whether or not you conceive a boy or a girl? 
- To study this, researchers asked women about their eating habits, including asking whether or not they ate 133 different foods regularly
]


.footnote[http://www.newscientist.com/article/dn13754-breakfast-cereals-boost-chances-of-conceiving-boys.html]

---

class: middle

# Diet and Sex of Baby

.hljs[For each of the 133 foods studied, a hypothesis test was conducted for a difference between mothers who conceived boys and girls in the proportion who consume each food]


.bql.font90[What are the null and alternative hypotheses?

Compare two populations: mothers who have boys vs. mothers who have girls

$\boldsymbol{p}_b$ : proportion of mothers who have boys that consume the food regularly

$\boldsymbol{p}_g$ : proportion of mothers who have girls that consume the food regularly


\begin{aligned}
& \mathrm{H}_0: p_b=p_g \\
& \mathrm{H}_a: p_b \neq p_g
\end{aligned}
]

---

class: middle

# Diet and Sex of Baby

A significant difference was found for breakfast cereal (mothers of boys eat more), prompting the headline

.green-h.center[“Breakfast Cereal Boosts Chances of 	Conceiving Boys”]

How might you explain this?

.bq[.B[Random chance]: several tests (about 6 or 7) are going to be significant, even if no differences exist]

---

class: middle

# Diet and Sex of Baby

> If there are NO differences (all 133 null hypotheses are true), about how many significant differences would be found using α = 0.05?

$$133 \pm 0.05 = 6.65$$
.bq[Expect about 6-7 statistically significant foods even if the rate of food consumption is equal for women who have boys and women who have girls]


---

class: middle

# Multiple Comparisons

.bq[The most important thing is to be aware of this issue, and not to trust claims that are obviously one of many tests (unless they specifically mention an adjustment for multiple testing)]

.bq[There are ways to account for this (e.g. Bonferroni’s Correction), but these are beyond the scope of this class]



---

class: action

# <i class="fa fa-pencil-square-o" style="font-size:48px;color:purple">&nbsp;Your&nbsp;Turn&nbsp;`r (yt <- yt + 1)`</i>    

.pull-left[
![](https://media.giphy.com/media/RKApDdwsQ6jkwd6RNn/giphy.gif)
]

<br>


.pull-right[
<br>
<br>

> Please go over the class activity for today and let me know if you have any questions.

]

`r countdown(minutes = 10, seconds = 00, top = 0 , color_background = "inherit", padding = "3px 4px", font_size = "2em")`

